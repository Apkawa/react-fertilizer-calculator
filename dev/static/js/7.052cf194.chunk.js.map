{"version":3,"sources":["components/ui/IconButton.tsx","components/ui/ReduxForm/Input.tsx","components/ui/ReduxForm/normalizers.ts","hooks/ReduxForm.ts","components/Calculator/FertilizerSelect/SelectedListItem.tsx","components/ui/ReduxForm/Checkbox.tsx","components/ui/Modal/ModalContainer.tsx","components/ui/Icon.tsx","components/ui/Modal/Modal.tsx","components/Calculator/FertilizerManager/AddItemElementForm.tsx","components/Calculator/FertilizerManager/AddEditCompositionList.tsx","components/Calculator/FertilizerManager/AddEdit.tsx","components/Calculator/FertilizerManager/Item.tsx","components/Calculator/FertilizerManager/List.tsx","components/Calculator/FertilizerManager/index.ts"],"names":["IconButton","forwardRef","props","buttonRef","IconComponent","component","size","children","extraProps","useState","containerSize","setSize","theme","useTheme","useEffect","current","offsetWidth","type","ref","color","colors","background","StyledInput","styled","RebassInput","WrappedInput","input","label","lang","placeholder","Input","name","number","value","parseInt","decimal","parseFloat","useFormName","useContext","ReduxFormContext","form","useFormValues","formName","dispatch","useDispatch","useSelector","state","getFormValues","change","Element","delta","bg","flex","mx","px","minWidth","maxWidth","fontSize","flexDirection","alignItems","round","SelectedListItem","item","onRemove","needWeight","normalizedFertilizer","normalizeFertilizer","width","justifyContent","id","FERTILIZER_ELEMENT_NAMES","map","v","elements","key","margin","textAlign","padding","alignSelf","Cross","onClick","WrappedCheckbox","checked","Checkbox","StyledOverlay","Flex","window","pageYOffset","ModalContainer","modalRoot","el","document","querySelector","createElement","setAttribute","body","appendChild","useModalRoot","ReactDOM","createPortal","Helmet","backgroundColor","Icon","text","Modal","opened","button","container","closed","setClose","onClose","modalActions","open","close","renderCbProps","modal","title","AddItemElementForm","disabled","style","step","min","max","autoComplete","normalize","AddEditCompositionList","fields","push","formula","percent","f","i","remove","getInitialValues","formData","npk","composition","composition_enable","solution_density","solution_density_enable","AddEdit","reduxForm","FERTILIZER_EDIT_FORM_NAME","enableReinitialize","formValues","Form","MACRO_ELEMENT_NAMES","MICRO_ELEMENT_NAMES","FieldArray","marginRight","sx","whiteSpace","Item","fertilizer","marginBottom","Edit","initialValues","console","log","fertilizerPush","onSave","Trash","fertilizerRemove","List","fertilizers","calculator","Plus","onAdd","list","setList","newList","fertilizerSet","FertilizerManager"],"mappings":"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","file":"static/js/7.052cf194.chunk.js","sourcesContent":["import React, {forwardRef, MouseEventHandler, PropsWithChildren, useEffect, useState} from \"react\";\nimport {Button, ButtonProps} from \"rebass\";\nimport {EmotionIcon} from '@emotion-icons/emotion-icon'\n\nimport {useTheme} from \"emotion-theming\";\nimport {Theme} from \"@/themes/types\";\n\n\ninterface IconButtonProps extends\n  PropsWithChildren<Omit<ButtonProps, keyof React.HTMLProps<HTMLButtonElement>>> {\n  component: EmotionIcon,\n  disabled?: boolean,\n  onClick?: MouseEventHandler<HTMLButtonElement>,\n  size?: number | string\n}\n\nexport const IconButton = forwardRef<HTMLButtonElement, IconButtonProps>(\n  (props, buttonRef) => {\n    const {\n      component: IconComponent,\n      size = \"1.5em\",\n      children,\n      ...extraProps\n    } = props\n    const [containerSize, setSize] = useState<number | string>(size || 0)\n    const theme = useTheme<Theme>()\n\n    useEffect(() => {\n      if (!size && buttonRef && 'current' in buttonRef) {\n        setSize(buttonRef.current?.offsetWidth || 0)\n      }\n    }, [buttonRef, setSize, size])\n\n    return (\n      <Button type=\"button\" {...extraProps} ref={buttonRef}>\n        <IconComponent\n          color={theme.colors?.background}\n          size={containerSize}\n        />\n        {children}\n      </Button>\n    )\n  })\n","import React from \"react\";\nimport {Field as ReduxField} from \"redux-form\";\n\nimport {Input as RebassInput, InputProps as RebassInputProps} from \"@rebass/forms\";\nimport {ReduxFormComponentType, WrapperInputType} from \"./types\";\nimport styled from \"styled-components\";\n\ninterface InputProps extends RebassInputProps {\n  label?: string\n}\n\nexport const StyledInput = styled(RebassInput)`\n  ::-webkit-inner-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n  ::-webkit-outer-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n`\n\nexport const WrappedInput: WrapperInputType<InputProps> = ({input, label, type = \"text\", ...props}: any) =>\n  <StyledInput  {...props}\n                {...input}\n                type={type}\n                lang=\"en-US\"\n                placeholder={label}\n  />\n\n\n// TODO вывести тип\nexport const Input: ReduxFormComponentType<InputProps> = (\n  {\n    name,\n    ...props\n  }) => {\n\n  return (\n    <ReduxField\n      component={WrappedInput}\n      name={name}\n      {...props as any}\n    />\n  )\n}\n","\n\nexport function number(value: any) {\n  return value && parseInt(value)\n}\n\nexport function decimal(value: any) {\n  return value && parseFloat(value)\n}\n","import {useContext} from 'react'\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {change, FormContext, getFormValues, ReduxFormContext} from \"redux-form\";\n\nexport function useReduxForm(): FormContext {\n  return useContext(ReduxFormContext)\n}\n\nexport function useFormName(): string {\n  return useReduxForm().form\n}\n\nexport function useFormValues<FormValues=object>(formName: string): [FormValues, (name: string, value: any) => void] {\n  const dispatch = useDispatch()\n  const values = useSelector(state => getFormValues(formName)(state)) as FormValues\n\n  const setValue = (name: string, value: any) => {\n    dispatch(change(formName, name, value))\n  }\n  return [\n    values,\n    setValue\n    ]\n}\n","import React, {FunctionComponent} from \"react\";\nimport {Box, Card, Flex, Text} from \"rebass\";\nimport {Cross} from \"@styled-icons/entypo/Cross\"\nimport {FertilizerType} from \"./types\";\nimport {normalizeFertilizer} from \"@/calculator/fertilizer\";\nimport {FERTILIZER_ELEMENT_NAMES} from \"@/calculator/constants\";\nimport {IconButton} from \"../../ui/IconButton\";\nimport {round} from \"@/utils\";\n\ninterface ElementProps {\n  name: string,\n  value: number,\n  delta?: number,\n}\n\nexport const Element: FunctionComponent<ElementProps> = (props) => {\n  const {name, value, delta} = props\n  return (\n    <Box bg={name} flex={1} mx=\"2px\" px={1} color={'black'} minWidth=\"2.1em\" maxWidth=\"3em\" fontSize={1}>\n      <Flex flexDirection='column' alignItems={'center'}>\n        <Box>{name}</Box>\n        <Box>{round(value, 1)}</Box>\n        {typeof delta !== \"undefined\"? <Box>{delta}</Box>: null}\n      </Flex>\n    </Box>\n  )\n}\n\ninterface SelectedListItemProps {\n  item: FertilizerType,\n  onRemove: () => void,\n  needWeight?: number,\n}\n\n\nexport const SelectedListItem: FunctionComponent<SelectedListItemProps> = ({item, onRemove, needWeight}) => {\n  const normalizedFertilizer = normalizeFertilizer(item, false)\n  return (\n    <Card width={'auto'}>\n      <Flex justifyContent={'space-between'} alignItems=\"center\">\n        <Box flex={1}>\n          <Text flex={1}>\n            {item.id}\n          </Text>\n          <Flex>\n            {\n              FERTILIZER_ELEMENT_NAMES.map((name) => {\n                  let v = normalizedFertilizer.elements[name]\n                  if (!v) {\n                    return null\n                  }\n                  return <Element\n                    name={name}\n                    key={name}\n                    value={v}\n                  />\n                }\n              )\n            }\n          </Flex>\n        </Box>\n        <Flex>\n          <Flex alignItems=\"center\" justifyContent=\"center\" margin={1}>\n            <Text textAlign=\"center\" minWidth=\"3em\">\n              {needWeight || 0}\n            </Text>\n          </Flex>\n          <IconButton\n            padding={1}\n            alignSelf=\"center\"\n            component={Cross}\n            onClick={() => onRemove()}\n          />\n        </Flex>\n      </Flex>\n    </Card>\n  )\n}\n","import React from \"react\";\n\nimport {Checkbox as RebassCheckbox, CheckboxProps as RebassCheckboxProps, Label} from \"@rebass/forms\";\nimport {Field as ReduxField} from \"redux-form\";\nimport {ReduxFormComponentType, WrapperInputType} from \"./types\";\n\ninterface CheckboxProps extends RebassCheckboxProps {\n  label: string\n}\n\nconst WrappedCheckbox: WrapperInputType<CheckboxProps> = ({input, label, ...props}: any) =>\n  <Label>\n    <RebassCheckbox\n      {...props} {...input}\n      checked={input.value}\n    />\n    {label}\n  </Label>\n\n// TODO вывести тип\nexport const Checkbox: ReduxFormComponentType<CheckboxProps> = ({name, ...props}) => {\n  return (\n    <ReduxField\n      component={WrappedCheckbox}\n      name={name}\n      {...props as any}\n    />\n  )\n}\n\n","import React, {ReactNode} from \"react\";\nimport ReactDOM from 'react-dom'\nimport {Card, Flex} from \"rebass\";\nimport styled from '@emotion/styled'\nimport {Helmet} from \"react-helmet\";\n\n\ninterface ModalContainerProps {\n  children: ReactNode,\n}\n\nconst useModalRoot = () => {\n  let el = document.querySelector('#modal-root')\n  if (!el) {\n    el = document.createElement('div')\n    el.setAttribute('id', 'modal-root')\n    document.body.appendChild(el)\n  }\n  return el\n}\n\nconst StyledOverlay = styled(Flex)`\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: ${() => `${window.pageYOffset}px`};\n  left: 0;\n  justify-content: center;\n  align-items: center;\n  background-color: rgba(255, 255, 255, 0.5);\n  z-index: 999;\n`\n\nexport function ModalContainer(props: ModalContainerProps) {\n  const {\n    children,\n  } = props\n  const modalRoot = useModalRoot()\n  return ReactDOM.createPortal(\n    <>\n      <Helmet>\n        <style type='text/css'>\n          {`\n          body {\n            overflow: hidden;\n          }\n        `}\n        </style>\n      </Helmet>\n      <StyledOverlay>\n        <Card backgroundColor='#fff'>\n          {children}\n        </Card>\n      </StyledOverlay>\n    </>\n    , modalRoot)\n}\n","import React, {forwardRef, useEffect, useState} from \"react\";\nimport {Box, BoxProps} from \"rebass\";\nimport {EmotionIcon} from '@emotion-icons/emotion-icon'\n\nimport {useTheme} from \"emotion-theming\";\nimport {Theme} from \"@/themes/types\";\n\n\ninterface IconProps extends Omit<BoxProps, keyof HTMLDivElement | 'css'> {\n  component: EmotionIcon,\n  disabled?: boolean,\n  size?: number | string\n}\n\nexport const Icon = forwardRef<HTMLDivElement, IconProps>(\n  (props, buttonRef) => {\n    const {\n      component: IconComponent,\n      size = \"1.5em\",\n      children,\n      ...extraProps\n    } = props\n    const [containerSize, setSize] = useState<number | string>(size || 0)\n    const theme = useTheme<Theme>()\n\n    useEffect(() => {\n      if (!size && buttonRef && 'current' in buttonRef) {\n        setSize(buttonRef.current?.offsetWidth || 0)\n      }\n    }, [buttonRef, setSize, size])\n\n    return (\n      <Box {...extraProps} ref={buttonRef}>\n        <IconComponent\n          color={theme.colors?.text}\n          size={containerSize}\n        />\n      </Box>\n    )\n  })\n","import React, {ReactNode, useEffect, useState} from \"react\";\nimport {ModalContainer} from \"@/components/ui/Modal/ModalContainer\";\nimport {Box, Flex, Heading} from \"rebass\";\nimport {Icon} from \"@/components/ui/Icon\";\nimport {Cross} from \"@styled-icons/entypo/Cross\";\n\nexport interface ModalActions {\n  open: () => void,\n  close: () => void,\n}\n\ntype RenderCb = (props: {modal: ModalActions}) => ReactNode\n\ninterface ModalProps {\n  opened?: boolean,\n  onClose?: () => void,\n  button?: RenderCb,\n  title?: string,\n  container: RenderCb,\n}\n\nexport function Modal(props: ModalProps) {\n  const {\n    opened = false,\n    button,\n    container,\n  } = props\n\n  const [closed, setClose] = useState(!opened)\n\n  useEffect(() => {\n    setClose(!opened)\n  }, [opened])\n\n  useEffect(() => {\n    if (closed && props.onClose) {\n      props.onClose()\n    }\n  }, [closed, props])\n\n  const modalActions: ModalActions = {\n    open: () => setClose(false),\n    close: () => setClose(true),\n  }\n  const renderCbProps = {modal: modalActions}\n\n  return (\n    <>\n      {button && button(renderCbProps)}\n      {closed ? null : <ModalContainer>\n        <Flex justifyContent='space-between'>\n          <Heading fontSize={2}>{props.title}</Heading>\n          <Icon component={Cross} onClick={modalActions.close}/>\n        </Flex>\n        <Box>\n          {container(renderCbProps)}\n        </Box>\n      </ModalContainer>\n      }\n    </>\n  )\n}\n","import React, {FunctionComponent} from \"react\";\nimport {Flex} from \"rebass\";\nimport {Input} from \"@/components/ui/ReduxForm/Input\";\nimport {decimal} from \"@/components/ui/ReduxForm/normalizers\";\n\ninterface RecipeElementFormProps {\n  name: string,\n  disabled?: boolean\n}\n\n\n\n\nexport const AddItemElementForm: FunctionComponent<RecipeElementFormProps> = (props) => {\n  const {name, disabled} = props\n\n  return (\n    <Flex flexDirection=\"column\" justifyContent=\"center\" alignItems=\"center\" width='4rem'>\n      <label style={{textAlign: 'center'}}>\n        {name}\n      </label>\n      <Input\n        name={'npk.' + name}\n        type=\"number\"\n        step=\"0.1\"\n        min=\"0\"\n        max=\"100\"\n        autoComplete=\"off\"\n        width=\"3rem\"\n        style={{\n          textAlign: \"center\"\n        }}\n        normalize={decimal}\n        disabled={disabled}\n      />\n    </Flex>\n  )\n}\n","import React from \"react\";\nimport {ReduxFieldArrayType} from \"@/components/ui/ReduxForm/types\";\nimport {Card, Flex} from \"rebass\";\nimport {FertilizerComposition} from \"@/calculator/types\";\nimport {Input} from \"@/components/ui/ReduxForm/Input\";\nimport {decimal} from \"@/components/ui/ReduxForm/normalizers\";\n\ninterface AddEditCompositionListProps {\n}\n\ntype AddEditCompositionListType = ReduxFieldArrayType<AddEditCompositionListProps, FertilizerComposition>\nexport const AddEditCompositionList: AddEditCompositionListType = (props) => {\n  const {fields} = props\n  return (\n    <Card width=\"100%\">\n      <Flex>\n        <button type=\"button\"  onClick={() => fields.push({formula: '', percent: 98})}>+</button>\n      </Flex>\n      <Flex flexDirection=\"column\">\n        {fields.map((f, i) => (\n          <Flex key={i} width=\"100%\">\n            <Input name={`${f}.formula`} flex={2}/>\n            <Input\n              name={`${f}.percent`}\n              type=\"number\"\n              step=\"0.1\"\n              min=\"0\"\n              max=\"100\"\n              normalize={decimal}\n              flex={1}\n            />\n            <button type=\"button\" onClick={() => fields.remove(i)}>-</button>\n          </Flex>\n        ))}\n      </Flex>\n    </Card>\n  )\n}\n","import React from \"react\";\nimport {Box, Flex, Text} from \"rebass\";\n\nimport {FieldArray, Form, reduxForm} from 'redux-form'\nimport {ReduxFormType} from \"@/components/ui/ReduxForm/types\";\nimport {Input} from \"@/components/ui/ReduxForm/Input\";\nimport {normalizeFertilizer} from \"@/calculator/fertilizer\";\nimport {MACRO_ELEMENT_NAMES, MICRO_ELEMENT_NAMES} from \"@/calculator/constants\";\nimport {FertilizerInfo} from \"@/calculator/types\";\n\nimport {AddItemElementForm} from \"./AddItemElementForm\";\n\nimport {FERTILIZER_EDIT_FORM_NAME} from \"./constants\";\nimport {AddEditFormType} from \"./types\";\nimport {Checkbox} from \"@/components/ui/ReduxForm/Checkbox\";\nimport {AddEditCompositionList} from \"@/components/Calculator/FertilizerManager/AddEditCompositionList\";\nimport {useFormName, useFormValues} from \"@/hooks/ReduxForm\";\nimport {decimal} from \"@/components/ui/ReduxForm/normalizers\";\n\ninterface AddEditProps {\n  fertilizer?: FertilizerInfo,\n}\n\nexport const getElements = (f: FertilizerInfo) => {\n  return normalizeFertilizer(f, false).elements\n}\n\nexport function getInitialValues(f: FertilizerInfo): AddEditFormType {\n  let formData: AddEditFormType = {\n    id: f.id,\n    npk: f.npk,\n    composition: f.composition,\n  }\n  if (f.composition) {\n    formData.npk = normalizeFertilizer(f, false).elements\n    formData.composition_enable = true\n  }\n  if (f.solution_density) {\n    formData.solution_density = f.solution_density\n    formData.solution_density_enable = true\n  }\n  return formData\n}\n\nconst AddEditForm: ReduxFormType<AddEditProps, AddEditFormType> = (props) => {\n  const formValues = useFormValues<AddEditFormType>(useFormName())[0]\n\n  return (\n    <Form>\n      <Flex flexDirection='column'>\n        <Input name=\"id\" title=\"Name\" label=\"Name\"/>\n        <Box>\n          Макроэлементы\n        </Box>\n        <Flex>\n          {MACRO_ELEMENT_NAMES.map(el => (\n            <AddItemElementForm\n              name={el}\n              disabled={formValues.composition_enable}\n            />\n          ))}\n        </Flex>\n        <Box>\n          Микроэлементы\n        </Box>\n        <Flex>\n          {MICRO_ELEMENT_NAMES.map(el => (\n            <AddItemElementForm\n              name={el}\n              disabled={formValues.composition_enable}\n            />\n          ))}\n        </Flex>\n        <Flex>\n          <Checkbox name=\"composition_enable\" label=\"Формула\"/>\n        </Flex>\n        {formValues.composition_enable ?\n          <Flex>\n            <FieldArray<{}>\n              name=\"composition\"\n              component={AddEditCompositionList}\n            />\n          </Flex> : null\n        }\n        <Flex alignItems='center'>\n          <Box width=\"auto\" marginRight={2}>\n            <Checkbox\n              name=\"solution_density_enable\" label=\"Раствор\"\n            />\n          </Box>\n          {formValues.solution_density_enable ?\n            <Flex alignItems=\"flex-end\">\n              <Input\n                name=\"solution_density\"\n                type=\"number\"\n                step=\"0.1\"\n                min=\"0\"\n                max=\"1000\"\n                normalize={decimal}\n                width='4rem'\n                marginRight={2}\n              />\n              <Text sx={{whiteSpace: 'nowrap'}}>г/л</Text>\n            </Flex>\n            : null}\n        </Flex>\n      </Flex>\n    </Form>\n  )\n}\n\n\nexport const AddEdit = reduxForm<AddEditFormType>({\n  form: FERTILIZER_EDIT_FORM_NAME,\n  enableReinitialize: true\n})(AddEditForm)\n","import React from \"react\";\nimport {FertilizerInfo} from \"@/calculator/types\";\nimport {Box, Button, Card, Flex, Text} from \"rebass\";\n\nimport {normalizeFertilizer} from \"@/calculator/fertilizer\";\nimport {FERTILIZER_ELEMENT_NAMES} from \"@/calculator/constants\";\n\nimport {IconButton} from \"@/components/ui/IconButton\";\nimport {Edit} from \"@styled-icons/fa-regular/Edit\"\nimport {Trash} from \"@styled-icons/fa-solid/Trash\";\n\nimport {Element} from \"../FertilizerSelect/SelectedListItem\";\nimport {AddEdit, getInitialValues} from './AddEdit';\nimport {Modal, ModalActions} from \"@/components/ui/Modal/Modal\";\nimport {useFormValues} from \"@/hooks/ReduxForm\";\nimport {FERTILIZER_EDIT_FORM_NAME} from \"@/components/Calculator/FertilizerManager/constants\";\nimport {useDispatch} from \"react-redux\";\nimport {fertilizerPush, fertilizerRemove} from \"@/components/Calculator/actions\";\nimport {AddEditFormType} from \"@/components/Calculator/FertilizerManager/types\";\n\ninterface ItemProps {\n  fertilizer: FertilizerInfo\n}\n\nexport function Item(props: ItemProps) {\n  const {fertilizer} = props\n  const normalizedFertilizer = normalizeFertilizer(fertilizer, false)\n  const [formValues] = useFormValues<AddEditFormType>(FERTILIZER_EDIT_FORM_NAME)\n  const dispatch = useDispatch()\n  const onRemove = () => {\n    dispatch(fertilizerRemove(fertilizer))\n  }\n  const onSave = (modal: ModalActions) => {\n    const f: FertilizerInfo = {\n      id: fertilizer.id,\n      name: formValues.id,\n    }\n    if (formValues.composition_enable) {\n      f.composition = formValues.composition\n    } else {\n      f.npk = formValues.npk\n    }\n    if (formValues.solution_density_enable) {\n      f.solution_density = formValues.solution_density\n    }\n    console.log(formValues)\n    dispatch(fertilizerPush(f))\n    modal.close()\n  }\n  return (\n    <>\n      <Card width={'auto'} marginBottom={2}>\n        <Flex justifyContent={'space-between'} alignItems=\"center\">\n          <Box flex={1}>\n            <Text flex={1}>\n              {fertilizer.id} {fertilizer.solution_density && `[жидкий ${fertilizer.solution_density} г/л]`}\n            </Text>\n            <Flex>\n              {\n                FERTILIZER_ELEMENT_NAMES.map((name) => {\n                    let v = normalizedFertilizer.elements[name]\n                    if (!v) {\n                      return null\n                    }\n                    return <Element\n                      name={name}\n                      key={name}\n                      value={v}\n                    />\n                  }\n                )\n              }\n            </Flex>\n          </Box>\n          <Flex>\n            <Modal\n              button={({modal}) => (\n                <IconButton\n                  padding={1}\n                  alignSelf=\"center\"\n                  component={Edit}\n                  backgroundColor={'primary'}\n                  onClick={modal.open}\n                />\n              )}\n              container={({modal}) => (\n                <>\n                <AddEdit\n                  initialValues={getInitialValues(fertilizer)}\n                />\n                  <Flex justifyContent=\"flex-end\">\n                    <Button type=\"button\" onClick={() => onSave(modal)}>Save</Button>\n                  </Flex>\n                </>\n              )}\n            />\n            <IconButton\n              padding={1}\n              alignSelf=\"center\"\n              component={Trash}\n              backgroundColor={'danger'}\n              onClick={onRemove}\n            />\n          </Flex>\n        </Flex>\n      </Card>\n    </>\n  )\n}\n","import React from \"react\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {CalculatorState} from \"@/components/Calculator/types\";\nimport {Button, Flex} from \"rebass\";\nimport {ReactSortable} from \"react-sortablejs\";\n\nimport {Item} from \"./Item\";\nimport {fertilizerPush, fertilizerSet} from \"@/components/Calculator/actions\";\nimport {Modal, ModalActions} from \"@/components/ui/Modal/Modal\";\nimport {IconButton} from \"@/components/ui/IconButton\";\nimport {Plus} from \"@styled-icons/boxicons-regular/Plus\";\nimport {AddEdit, getInitialValues} from \"@/components/Calculator/FertilizerManager/AddEdit\";\nimport {useFormValues} from \"@/hooks/ReduxForm\";\nimport {AddEditFormType} from \"@/components/Calculator/FertilizerManager/types\";\nimport {FERTILIZER_EDIT_FORM_NAME} from \"@/components/Calculator/FertilizerManager/constants\";\nimport {FertilizerInfo} from \"@/calculator/types\";\n\ninterface ListProps {\n}\n\nexport function List(props: ListProps) {\n  const {\n    fertilizers,\n  } = useSelector<any>(state => state.calculator) as CalculatorState\n  const [formValues] = useFormValues<AddEditFormType>(FERTILIZER_EDIT_FORM_NAME)\n  const dispatch = useDispatch()\n\n  function onAdd(modal: ModalActions) {\n    const f: FertilizerInfo = {\n      id: formValues.id,\n      name: formValues.id,\n    }\n    if (formValues.composition_enable) {\n      f.composition = formValues.composition\n    } else {\n      f.npk = formValues.npk\n    }\n    if (formValues.solution_density_enable) {\n      f.solution_density = formValues.solution_density\n    }\n    dispatch(fertilizerPush(f))\n    modal.close()\n\n  }\n\n  return (\n    <Flex flexDirection='column'>\n      <Flex>\n        <Modal\n          button={({modal}) => (\n            <IconButton\n              padding={1}\n              alignSelf=\"center\"\n              component={Plus}\n              backgroundColor={'primary'}\n              onClick={modal.open}\n            />\n          )}\n          container={({modal}) => (\n            <>\n              <AddEdit\n                initialValues={getInitialValues({id: ''})}\n              />\n              <Flex justifyContent=\"flex-end\">\n                <Button type=\"button\" onClick={() => onAdd(modal)}>Save</Button>\n              </Flex>\n            </>\n          )}\n        />\n      </Flex>\n      <ReactSortable list={fertilizers} setList={newList => dispatch(fertilizerSet(newList))}>\n        {fertilizers.map(f => (\n          <Item fertilizer={f} key={f.id}/>\n        ))}\n      </ReactSortable>\n    </Flex>\n  )\n}\n","import {List as FertilizerManager} from './List'\n\nexport {List as FertilizerManager} from './List'\n\nexport default FertilizerManager\n"],"sourceRoot":""}