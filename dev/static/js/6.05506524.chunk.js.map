{"version":3,"sources":["components/ui/IconButton.tsx","components/ui/ReduxForm/Input.tsx","components/ui/ReduxForm/normalizers.ts","hooks/ReduxForm.ts","components/Calculator/FertilizerSelect/SelectedListItem.tsx","components/ui/ReduxForm/Checkbox.tsx","components/ui/Dropdown/context.ts","components/ui/Dropdown/DropdownItem.tsx","components/ui/Dropdown/DropdownList.tsx","components/ui/Dropdown/Dropdown.tsx","components/ui/Modal/ModalContainer.tsx","components/ui/Icon.tsx","components/ui/Modal/Modal.tsx","components/Calculator/FertilizerSelect/AddItemElementForm.tsx","components/Calculator/FertilizerSelect/AddItemFertilizerEditForm.tsx","components/Calculator/FertilizerSelect/AddItem.tsx","components/Calculator/FertilizerSelect/SelectedList.tsx","components/Calculator/FertilizerSelect/Container.tsx","components/Calculator/FertilizerSelect/index.ts","components/ui/ReduxForm/validators.ts","components/Calculator/Options/IgnoreElement.tsx","components/ui/ReduxForm/Radio.tsx","components/Calculator/Options/Accuracy.tsx","components/Calculator/Options/Solution.tsx","components/Calculator/Options/Dilution.tsx","components/Calculator/Options/Options.tsx","components/Calculator/Options/RecipeElementForm.tsx","components/Calculator/Options/RecipeTuneForm.tsx","components/Calculator/Options/Recipe.tsx","components/Calculator/Result/ResultFertilizerList.tsx","components/Calculator/Result/hooks.ts","calculator/dilution.ts","components/Calculator/Result/ResultDilution.tsx","components/Calculator/Result/Result.tsx","utils/csv.ts","components/Calculator/ImportExport/ImportFertilizers.tsx","utils/downloads.ts","components/Calculator/ImportExport/ExportFertilizers.tsx","components/Calculator/ImportExport/ExportRecipes.tsx","components/Calculator/ImportExport/ImportRecipes.tsx","components/ui/styled.ts","components/Calculator/index.tsx"],"names":["IconButton","forwardRef","props","buttonRef","IconComponent","component","size","children","extraProps","useState","containerSize","setSize","theme","useTheme","useEffect","current","offsetWidth","type","ref","color","colors","background","StyledInput","styled","RebassInput","WrappedInput","input","label","lang","placeholder","Input","name","number","value","parseInt","decimal","parseFloat","useFormName","useContext","ReduxFormContext","form","useFormValues","formName","dispatch","useDispatch","useSelector","state","getFormValues","change","Element","delta","bg","flex","mx","px","minWidth","maxWidth","fontSize","flexDirection","alignItems","round","SelectedListItem","item","onRemove","weight","normalizedFertilizer","normalizeFertilizer","width","justifyContent","id","FERTILIZER_ELEMENT_NAMES","map","v","elements","key","margin","textAlign","volume","title","liquid_weight","padding","alignSelf","Cross","onClick","WrappedCheckbox","checked","Checkbox","DropdownContext","React","createContext","ItemContainer","sx","position","zIndex","backgroundColor","content","left","top","opacity","height","StyledItemBox","Box","disabled","css","DropdownItem","index","ctx","onItemClick","checkDisabledItem","renderItem","DropdownList","items","itemRef","useRef","setHeight","offsetHeight","maxHeight","overflowY","Array","from","s","i","length","style","IconDown","ChevronDownSquare","text","Dropdown","renderValue","opened","setOpened","setItem","setValue","editing","setEditing","containerRef","handleClickOutside","event","contains","target","document","addEventListener","removeEventListener","onClickItemHandler","onChange","context","Provider","val","onKeyDown","stopPropagation","onEdit","onBlur","right","StyledOverlay","Flex","window","pageYOffset","ModalContainer","modalRoot","el","querySelector","createElement","setAttribute","body","appendChild","useModalRoot","ReactDOM","createPortal","Helmet","Icon","Modal","button","container","closed","setClose","onClose","modalActions","open","close","renderCbProps","modal","AddItemElementForm","step","min","max","autoComplete","toString","getElements","f","AddItemFertilizerEditForm","fertilizer","setElements","MACRO_ELEMENT_NAMES","AddItem","onAdd","fertilizers","calculator","calculationForm","selected","setSelected","fertilizersIDs","pr","includes","Plus","SelectedList","fields","error","meta","result","calculatedFertilizersWeights","Object","fromEntries","push","marginTop","remove","Container","FieldArray","validate","message","IgnoreElement","Radio","normalize","ACCURACY_VARIANTS","Accuracy","a","Solution","htmlFor","pattern","paddingTop","Dilution","dilution_enabled","REDUX_FORM_NAME","display","Options","my","marginLeft","getRecipeFieldName","RecipeElementForm","ELEMENT_IN_MATRIX","ALLOWED_ELEMENT_IN_MATRIX","filter","RecipeTuneForm","formValue","recipe","setRecipe","recipeInfo","calculateNPKBalance","ratio","setRatio","EC","setEC","onChangeRecipe","onChangeRatio","El1","El2","newNpk","convertProfileWithRatio","convertProfileWithEC","RecipeInput","ion_balance","NH4","NO3","K","Mg","Ca","N","P","el2","MICRO_ELEMENT_NAMES","onSave","e","StyledBalanceCell","m","Recipe","recipes","values","NPKBalance","getEmptyElements","entries","zeroValues","recipeRemove","onRemoveItemHandler","marginRight","Save","recipePush","Broom","n","Tune","ResultFertilizerList","accuracy","countDecimals","usePPM","solution_volume","fertilizerWeights","calculatePPM","useFertilizerSolutionGroup","fertilizersWeights","fertilizerWeightsMap","toMap","groups","nf","A","S","B","C","groupFertilizerBySolution","sort","ResultDilution","solution_concentration","dilution_volume","dilution_concentration","fertilizerWeightGroups","ppm","dilution","sources","concentration","dilution_solution","d","ppmToEC","StyledList","ul","Result","score","deltaElements","k","score_display","getScoreDisplay","g","f_weights","stats","count","time","csvParse","parse","csvExport","stringify","COLUMNS","ImportFertilizers","createRef","newSize","handleOnChange","console","log","files","file","reader","FileReader","onload","csv","p","columns","isNaN","splice","npk","buildNPKFertilizer","fertilizerPush","loadCSV","readAsText","Import","accept","saveData","data","fileName","blob","Blob","url","URL","createObjectURL","href","download","click","revokeObjectURL","ExportFertilizers","rows","cols","csvData","header","Export","ExportRecipes","ImportRecipes","mobileStyles","styles","initialValues","DEFAULT_RECIPES","DEFAULT_MICRO_RECIPE","Cl","CalculatorContainer","handleSubmit","Form","onSubmit","calculateStart","FertilizerSelect","marginBottom","paddingBottom","flexWrap","Restart","fertilizerReset","recipeReset","InitializerCalculator","reduxForm","enableReinitialize","ReduxCalculator","connect","formValues"],"mappings":"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","file":"static/js/6.05506524.chunk.js","sourcesContent":["import React, {forwardRef, MouseEventHandler, PropsWithChildren, useEffect, useState} from \"react\";\nimport {Button, ButtonProps} from \"rebass\";\nimport {EmotionIcon} from '@emotion-icons/emotion-icon'\n\nimport {useTheme} from \"emotion-theming\";\nimport {Theme} from \"@/themes/types\";\n\n\ninterface IconButtonProps extends\n  PropsWithChildren<Omit<ButtonProps, keyof React.HTMLProps<HTMLButtonElement>>> {\n  component: EmotionIcon,\n  disabled?: boolean,\n  onClick?: MouseEventHandler<HTMLButtonElement>,\n  size?: number | string\n}\n\nexport const IconButton = forwardRef<HTMLButtonElement, IconButtonProps>(\n  (props, buttonRef) => {\n    const {\n      component: IconComponent,\n      size = \"1.5em\",\n      children,\n      ...extraProps\n    } = props\n    const [containerSize, setSize] = useState<number | string>(size || 0)\n    const theme = useTheme<Theme>()\n\n    useEffect(() => {\n      if (!size && buttonRef && 'current' in buttonRef) {\n        setSize(buttonRef.current?.offsetWidth || 0)\n      }\n    }, [buttonRef, setSize, size])\n\n    return (\n      <Button type=\"button\" {...extraProps} ref={buttonRef}>\n        <IconComponent\n          color={theme.colors?.background}\n          size={containerSize}\n        />\n        {children}\n      </Button>\n    )\n  })\n","import React from \"react\";\nimport {Field as ReduxField} from \"redux-form\";\n\nimport {Input as RebassInput, InputProps as RebassInputProps} from \"@rebass/forms\";\nimport {ReduxFormComponentType, WrapperInputType} from \"./types\";\nimport styled from \"styled-components\";\n\ninterface InputProps extends RebassInputProps {\n  label?: string\n}\n\nexport const StyledInput = styled(RebassInput)`\n  ::-webkit-inner-spin-button, ::-webkit-outer-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n  -moz-appearance: textfield;\n\n`\n\nexport const WrappedInput: WrapperInputType<InputProps> = ({input, label, type = \"text\", ...props}: any) =>\n  <StyledInput  {...props}\n                {...input}\n                type={type}\n                lang=\"en-US\"\n                placeholder={label}\n  />\n\n\n// TODO вывести тип\nexport const Input: ReduxFormComponentType<InputProps> = (\n  {\n    name,\n    ...props\n  }) => {\n\n  return (\n    <ReduxField\n      component={WrappedInput}\n      name={name}\n      {...props as any}\n    />\n  )\n}\n","\n\nexport function number(value: any) {\n  return value && parseInt(value)\n}\n\nexport function decimal(value: any) {\n  return value && parseFloat(value)\n}\n","import {useContext} from 'react'\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {change, FormContext, getFormValues, ReduxFormContext} from \"redux-form\";\n\nexport function useReduxForm(): FormContext {\n  return useContext(ReduxFormContext)\n}\n\nexport function useFormName(): string {\n  return useReduxForm().form\n}\n\nexport function useFormValues<FormValues=object>(formName: string): [FormValues, (name: string, value: any) => void] {\n  const dispatch = useDispatch()\n  const values = useSelector(state => getFormValues(formName)(state)) as FormValues\n\n  const setValue = (name: string, value: any) => {\n    dispatch(change(formName, name, value))\n  }\n  return [\n    values,\n    setValue\n    ]\n}\n","import React, {FunctionComponent} from \"react\";\nimport {Box, Card, Flex, Text} from \"rebass\";\nimport {Cross} from \"@styled-icons/entypo/Cross\"\nimport {FertilizerType} from \"./types\";\nimport {normalizeFertilizer} from \"@/calculator/fertilizer\";\nimport {FERTILIZER_ELEMENT_NAMES} from \"@/calculator/constants\";\nimport {IconButton} from \"../../ui/IconButton\";\nimport {round} from \"@/utils\";\nimport {FertilizerWeights} from \"@/calculator\";\n\ninterface ElementProps {\n  name: string,\n  value: number,\n  delta?: number,\n}\n\nexport const Element: FunctionComponent<ElementProps> = (props) => {\n  const {name, value, delta} = props\n  return (\n    <Box bg={name} flex={1} mx=\"2px\" px={1} color={'black'} minWidth=\"2.1em\" maxWidth=\"3em\" fontSize={1}>\n      <Flex flexDirection='column' alignItems={'center'}>\n        <Box>{name}</Box>\n        <Box>{round(value, 1)}</Box>\n        {typeof delta !== \"undefined\" ? <Box>{delta}</Box> : null}\n      </Flex>\n    </Box>\n  )\n}\n\ninterface SelectedListItemProps {\n  item: FertilizerType,\n  onRemove: () => void,\n  weight?: FertilizerWeights,\n}\n\n\nexport const SelectedListItem: FunctionComponent<SelectedListItemProps> = ({item, onRemove, weight}) => {\n  const normalizedFertilizer = normalizeFertilizer(item, false)\n  return (\n    <Card width={'auto'}>\n      <Flex justifyContent={'space-between'} alignItems=\"center\">\n        <Box flex={1}>\n          <Text flex={1}>\n            {item.id}\n          </Text>\n          <Flex>\n            {\n              FERTILIZER_ELEMENT_NAMES.map((name) => {\n                  let v = normalizedFertilizer.elements[name]\n                  if (!v) {\n                    return null\n                  }\n                  return <Element\n                    name={name}\n                    key={name}\n                    value={v}\n                  />\n                }\n              )\n            }\n          </Flex>\n        </Box>\n        <Flex>\n          <Flex alignItems=\"center\" justifyContent=\"center\" margin={1}>\n            {weight ? (\n              <Text textAlign=\"center\" minWidth=\"3em\">\n                {weight.weight}г\n                {weight.volume ? (\n                  <>\n                    <br/>\n                    <span\n                      title=\"Объем или вес раствора\">{weight.volume && `${weight.volume} мл${weight.liquid_weight? `, ${weight.liquid_weight}г`:''}`}</span>\n                  </>\n                ) : null}\n              </Text>\n            ) : null}\n          </Flex>\n          <IconButton\n            padding={1}\n            alignSelf=\"center\"\n            component={Cross}\n            onClick={() => onRemove()}\n          />\n        </Flex>\n      </Flex>\n    </Card>\n  )\n}\n","import React from \"react\";\n\nimport {Checkbox as RebassCheckbox, CheckboxProps as RebassCheckboxProps, Label} from \"@rebass/forms\";\nimport {Field as ReduxField} from \"redux-form\";\nimport {ReduxFormComponentType, WrapperInputType} from \"./types\";\n\ninterface CheckboxProps extends RebassCheckboxProps {\n  label: string\n}\n\nconst WrappedCheckbox: WrapperInputType<CheckboxProps> = ({input, label, ...props}: any) =>\n  <Label>\n    <RebassCheckbox\n      {...props} {...input}\n      checked={input.value}\n    />\n    {label}\n  </Label>\n\n// TODO вывести тип\nexport const Checkbox: ReduxFormComponentType<CheckboxProps> = ({name, ...props}) => {\n  return (\n    <ReduxField\n      component={WrappedCheckbox}\n      name={name}\n      {...props as any}\n    />\n  )\n}\n\n","import React, {Context} from \"react\";\nimport {ItemCallback, RenderItemCallback} from \"./types\";\n\n// TODO  сделать генерик\nexport interface DropdownContextInterface<T=any> {\n  onItemClick?: ItemCallback<T>,\n  renderItem?: RenderItemCallback<T>\n  checkDisabledItem?: ItemCallback<T,  boolean>,\n}\n\nexport type DropdownContext<T> = Context<DropdownContextInterface<T>>\nexport const DropdownContext: DropdownContext<any> = React.createContext({})\n\n\n","import React, {FunctionComponent, useContext} from \"react\";\nimport {Box, Flex} from \"rebass\";\n// import styled from '@emotion/styled'\nimport {DropdownContext} from \"./context\";\nimport styled, {css} from \"styled-components\";\n\ninterface DropdownItemProps<T> {\n  value: T,\n  index: number,\n}\n\n\nconst ItemContainer: FunctionComponent = ({\n                                            children,\n                                          }) => {\n  return <Flex\n    padding={2}\n    sx={{\n      position: \"relative\",\n      zIndex: 1,\n      '&::before': {\n        backgroundColor: 'highlight',\n        content: '\"\"',\n        position: \"absolute\",\n        left: 0,\n        top: 0,\n        opacity: 0,\n        width: '100%',\n        height: '100%',\n        zIndex: -1,\n      },\n      '&:hover::before': {\n        opacity: 0.1,\n        // boxShadow: \"inset 0 0 0 99999px rgba(0,0,0,0.1)\"\n      }\n    }}\n  >\n    {children}\n  </Flex>\n\n}\n\nconst StyledItemBox = styled(Box)`\n  ${props => props.disabled \n    && css`\n      pointer-events: none;\n      opacity: 0.4;\n  `}\n\n`\n\nexport function DropdownItem<T>(props: DropdownItemProps<T>) {\n  const {value, index} = props;\n  const ctx = useContext(DropdownContext);\n\n  const renderItem = () => {\n    if (ctx.renderItem) {\n      return <ctx.renderItem item={value} index={index} />\n    }\n    return (value + '')\n  }\n\n  const onItemClickHandler = () => {\n    if (ctx.onItemClick) {\n      ctx.onItemClick(value)\n    }\n  }\n\n  return (\n    <StyledItemBox\n      onClick={onItemClickHandler}\n      disabled={ctx.checkDisabledItem && ctx.checkDisabledItem(value)}\n    >\n      <ItemContainer>\n        {renderItem()}\n      </ItemContainer>\n    </StyledItemBox>\n  )\n}\n","import React, {useEffect, useRef, useState} from \"react\";\nimport {Box, Card, Flex} from \"rebass\";\nimport {DropdownItem} from \"./DropdownItem\";\n\ninterface DropdownListProps<T> {\n  items: T[],\n}\n\nexport function DropdownList<T>(props: DropdownListProps<T>) {\n  const items = props.items\n\n  const itemRef = useRef<HTMLDivElement>()\n  const [height, setHeight] = useState(0)\n\n  useEffect(() => {\n    setHeight(itemRef?.current?.offsetHeight || 0)\n  }, [itemRef])\n\n  return (\n    <Card\n      backgroundColor={\"background\"}\n      padding={0}\n      maxHeight={height * 5}\n      overflowY={'auto'}\n      sx={{zIndex: 3}}\n    >\n      <Flex flexDirection=\"column\">\n        {Array.from(items).map((s, i) => {\n          return (\n            <Box ref={i === 0 ? itemRef: null}>\n              <DropdownItem<T>\n                value={s}\n                index={i}\n                key={i}\n              />\n              {i < items.length - 1 ? <hr style={{margin: 0}}/> : null}\n            </Box>\n          )\n        })}\n      </Flex>\n    </Card>\n  )\n}\n","import React, {ChangeEvent, KeyboardEvent, useEffect, useRef, useState} from \"react\";\nimport {Input} from \"@rebass/forms\";\nimport {Box, Flex} from \"rebass\";\nimport styled from '@emotion/styled'\nimport {ChevronDownSquare} from '@emotion-icons/boxicons-solid/ChevronDownSquare'\nimport {DropdownList} from \"./DropdownList\";\nimport {DropdownContext, DropdownContextInterface} from \"./context\";\nimport {ItemCallback, ItemType, RenderItemCallback, RenderValueCallback} from \"./types\";\n\nconst IconDown = styled(ChevronDownSquare)`\n  color: ${(props: any) => props.theme.colors.text};\n  height: 3rem;\n  opacity: 0.5;\n  \n  &:hover {\n    opacity: 0.7;\n  }\n`\n\nexport interface DropdownProps<T> {\n  value?: ItemType<T>,\n  items: T[],\n  renderValue?: RenderValueCallback<T>,\n  renderItem?: RenderItemCallback<T>,\n  checkDisabledItem?: ItemCallback<T,  boolean>,\n\n  onEdit?: (value: string) => void,\n  onChange?: (item: ItemType<T>) => void,\n  width?: number\n}\n\nexport function Dropdown<T>(props: DropdownProps<T>) {\n  const {width} = props\n  const renderValue: RenderValueCallback<T> = item => {\n    if (props.renderValue) {\n      return props.renderValue(item)\n    }\n    return (item || '') + ''\n  }\n\n  const [opened, setOpened] = useState(false)\n  const [item, setItem] = useState(props.value || null)\n  const [value, setValue] = useState(renderValue(props.value || null))\n  const [editing, setEditing] = useState(false)\n  const containerRef = useRef<HTMLDivElement>()\n\n  useEffect(() => {\n    function handleClickOutside(event: MouseEvent) {\n      if (containerRef.current\n        && !containerRef.current.contains(event.target as any)) {\n        setOpened(false)\n      }\n    }\n\n    document.addEventListener(\"mousedown\", handleClickOutside);\n    return () => {\n      document.removeEventListener(\"mousedown\", handleClickOutside);\n    };\n  }, [containerRef])\n\n  const onClickItemHandler = (item: ItemType<T>) => {\n    setItem(item)\n    setValue(renderValue(item))\n\n    props.onChange && props.onChange(item)\n    setEditing(false)\n    setOpened(false)\n  }\n  const onChangeInputHandler = (event: ChangeEvent<HTMLInputElement>) => {\n    const val = event.target.value\n    setValue(val)\n    setEditing(true)\n    setOpened(false)\n  }\n\n  const onKeyDownInputHandler = (event: KeyboardEvent<HTMLInputElement>) => {\n    event.stopPropagation()\n    if (event.key === 'Enter') {\n      props.onEdit && props.onEdit(value)\n    }\n    if (event.key === 'Escape') {\n      onClickItemHandler(item)\n    }\n  }\n\n  const onBlurInputHandler = () => {\n    if (editing) {\n      value && props.onEdit && props.onEdit(value)\n    }\n  }\n\n  const context: DropdownContextInterface<T> = {\n    onItemClick: onClickItemHandler,\n    renderItem: props.renderItem,\n    checkDisabledItem: props.checkDisabledItem,\n  }\n\n  return (\n    <DropdownContext.Provider value={context}>\n      <Flex flexDirection=\"column\" width={width} ref={containerRef}>\n        <Flex sx={{position: 'relative'}}>\n          <Input\n            value={value}\n            onChange={onChangeInputHandler}\n            onKeyDown={onKeyDownInputHandler}\n            onBlur={onBlurInputHandler}\n          />\n          <Box\n            sx={{\n              position: \"absolute\",\n              right: 0\n            }}\n          >\n            <IconDown\n              onClick={() => setOpened(!opened)}\n            />\n          </Box>\n        </Flex>\n        <Flex sx={{position: 'relative'}}>\n          <Flex sx={{position: \"absolute\"}}\n                flexDirection=\"column\"\n                width=\"100%\"\n          >\n            {opened && <DropdownList<T> items={props.items}/>}\n          </Flex>\n        </Flex>\n      </Flex>\n    </DropdownContext.Provider>\n  )\n}\n","import React, {ReactNode} from \"react\";\nimport ReactDOM from 'react-dom'\nimport {Card, Flex} from \"rebass\";\nimport styled from '@emotion/styled'\nimport {Helmet} from \"react-helmet\";\n\n\ninterface ModalContainerProps {\n  children: ReactNode,\n}\n\nconst useModalRoot = () => {\n  let el = document.querySelector('#modal-root')\n  if (!el) {\n    el = document.createElement('div')\n    el.setAttribute('id', 'modal-root')\n    document.body.appendChild(el)\n  }\n  return el\n}\n\nconst StyledOverlay = styled(Flex)`\n  overflow-y: auto;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: ${() => `${window.pageYOffset}px`};\n  left: 0;\n  justify-content: center;\n  align-items: center;\n  background-color: rgba(255, 255, 255, 0.5);\n  z-index: 999;\n  \n  // Mobile\n  @media screen and (max-height: 500px), screen and (max-width: 500px) {\n    align-items: initial;\n  }\n`\n\nexport function ModalContainer(props: ModalContainerProps) {\n  const {\n    children,\n  } = props\n  const modalRoot = useModalRoot()\n  return ReactDOM.createPortal(\n    <>\n      <Helmet>\n        <style type='text/css'>\n          {`\n          body {\n            overflow: hidden;\n          }\n        `}\n        </style>\n      </Helmet>\n      <StyledOverlay>\n        <Card backgroundColor='#fff' height=\"max-content\">\n          {children}\n        </Card>\n      </StyledOverlay>\n    </>\n    , modalRoot)\n}\n","import React, {forwardRef, useEffect, useState} from \"react\";\nimport {Box, BoxProps} from \"rebass\";\nimport {EmotionIcon} from '@emotion-icons/emotion-icon'\n\nimport {useTheme} from \"emotion-theming\";\nimport {Theme} from \"@/themes/types\";\n\n\ninterface IconProps extends Omit<BoxProps, keyof HTMLDivElement | 'css'> {\n  component: EmotionIcon,\n  disabled?: boolean,\n  size?: number | string\n}\n\nexport const Icon = forwardRef<HTMLDivElement, IconProps>(\n  (props, buttonRef) => {\n    const {\n      component: IconComponent,\n      size = \"1.5em\",\n      children,\n      ...extraProps\n    } = props\n    const [containerSize, setSize] = useState<number | string>(size || 0)\n    const theme = useTheme<Theme>()\n\n    useEffect(() => {\n      if (!size && buttonRef && 'current' in buttonRef) {\n        setSize(buttonRef.current?.offsetWidth || 0)\n      }\n    }, [buttonRef, setSize, size])\n\n    return (\n      <Box {...extraProps} ref={buttonRef}>\n        <IconComponent\n          color={theme.colors?.text}\n          size={containerSize}\n        />\n      </Box>\n    )\n  })\n","import React, {ReactNode, useEffect, useState} from \"react\";\nimport {ModalContainer} from \"@/components/ui/Modal/ModalContainer\";\nimport {Box, Flex, Heading} from \"rebass\";\nimport {Icon} from \"@/components/ui/Icon\";\nimport {Cross} from \"@styled-icons/entypo/Cross\";\n\nexport interface ModalActions {\n  open: () => void,\n  close: () => void,\n}\n\ntype RenderCb = (props: {modal: ModalActions}) => ReactNode\n\ninterface ModalProps {\n  opened?: boolean,\n  onClose?: () => void,\n  button?: RenderCb,\n  title?: string,\n  container: RenderCb,\n}\n\nexport function Modal(props: ModalProps) {\n  const {\n    opened = false,\n    button,\n    container,\n  } = props\n\n  const [closed, setClose] = useState(!opened)\n\n  useEffect(() => {\n    setClose(!opened)\n  }, [opened])\n\n  useEffect(() => {\n    if (closed && props.onClose) {\n      props.onClose()\n    }\n  }, [closed, props])\n\n  const modalActions: ModalActions = {\n    open: () => setClose(false),\n    close: () => setClose(true),\n  }\n  const renderCbProps = {modal: modalActions}\n\n  return (\n    <>\n      {button && button(renderCbProps)}\n      {closed ? null : <ModalContainer>\n        <Flex justifyContent='space-between'>\n          <Heading fontSize={2}>{props.title}</Heading>\n          <Icon component={Cross} onClick={modalActions.close}/>\n        </Flex>\n        <Box>\n          {container(renderCbProps)}\n        </Box>\n      </ModalContainer>\n      }\n    </>\n  )\n}\n","import React, {FunctionComponent, useEffect, useState} from \"react\";\nimport {Flex} from \"rebass\";\nimport {StyledInput} from \"@/components/ui/ReduxForm/Input\";\n\ninterface RecipeElementFormProps {\n  name: string,\n  value: number,\n  disabled?: boolean,\n  onChange?: (value: number) => void\n}\n\n\n\n\nexport const AddItemElementForm: FunctionComponent<RecipeElementFormProps> = (props) => {\n  const {name, disabled} = props\n  const [value, setValue] = useState(props.value)\n\n  useEffect(() => {\n    setValue(props.value)\n  }, [props.value])\n\n  const onChange = (value: string) => {\n    const v = parseFloat(value)\n    setValue(v)\n  }\n\n  const onBlur = () => {\n    props.onChange && props.onChange(value)\n  }\n\n  return (\n    <Flex flexDirection=\"column\" justifyContent=\"center\" alignItems=\"center\" width='4rem'>\n      <label style={{textAlign: 'center'}}>\n        {name}\n      </label>\n      <StyledInput\n        type=\"number\"\n        step=\"0.1\"\n        min=\"0\"\n        max=\"100\"\n        autoComplete=\"off\"\n        width=\"3rem\"\n        value={value.toString()}\n        disabled={disabled}\n        onChange={event => onChange(event.target.value)}\n        onBlur={onBlur}\n        style={{\n          textAlign: \"center\"\n        }}\n      />\n    </Flex>\n  )\n}\n","import React, {FunctionComponent, useEffect, useState} from \"react\";\nimport {Flex} from \"rebass\";\nimport {FERTILIZER_ELEMENT_NAMES, MACRO_ELEMENT_NAMES} from \"../../../calculator/constants\";\nimport {AddItemElementForm} from \"./AddItemElementForm\";\nimport {normalizeFertilizer} from \"../../../calculator/fertilizer\";\nimport {Elements, FertilizerInfo} from \"@/calculator/types\";\n\ninterface AddItemFertilizerEditFormProps {\n  fertilizer?: FertilizerInfo,\n  allowEdit?: boolean,\n  onChange: (item: FertilizerInfo) => void\n}\n\nexport const getElements = (f: FertilizerInfo) => {\n  return normalizeFertilizer(f, false).elements\n}\n\nexport const AddItemFertilizerEditForm: FunctionComponent<AddItemFertilizerEditFormProps> = (props) => {\n  const {\n    fertilizer,\n  } = props\n\n  const [elements, setElements] = useState<Elements|undefined>(fertilizer && getElements(fertilizer))\n\n  const onChangeHandler = (el: FERTILIZER_ELEMENT_NAMES, val: number) => {\n    if (!elements || !fertilizer){\n      return\n    }\n    props.onChange(fertilizer)\n  }\n\n  useEffect(() => {\n    setElements(fertilizer && getElements(fertilizer))\n  }, [fertilizer])\n\n  return (\n    <Flex>\n      <Flex>\n        {MACRO_ELEMENT_NAMES.map(el => (\n          <AddItemElementForm\n            disabled={true}\n            name={el}\n            value={elements?.[el]||0}\n            onChange={v => onChangeHandler(el, v)}\n          />\n        ))}\n      </Flex>\n    </Flex>\n  )\n}\n","import React, {FunctionComponent, useState} from \"react\";\nimport {Box, Card, Flex} from \"rebass\";\nimport {FertilizerType} from \"./types\";\nimport {Dropdown} from \"@/components/ui/Dropdown/Dropdown\";\nimport {Plus} from \"@styled-icons/boxicons-regular/Plus\"\n\nimport {useSelector} from \"react-redux\";\nimport {CalculatorState} from \"../types\";\nimport {AddItemFertilizerEditForm} from \"./AddItemFertilizerEditForm\";\nimport {IconButton} from \"@/components/ui/IconButton\";\nimport {FertilizerInfo} from \"@/calculator/types\";\n\ninterface AddItemProps {\n  onAdd: (item: FertilizerType) => void\n}\n\n\nexport const AddItem: FunctionComponent<AddItemProps> = ({onAdd}) => {\n  const {\n    fertilizers,\n  } = useSelector<any>(state => state.calculator) as CalculatorState\n  const {\n    calculationForm,\n  } = useSelector<any>(state => state.calculator) as CalculatorState\n\n  const [selected, setSelected] = useState<FertilizerInfo | undefined>(fertilizers[0])\n\n  const selectedFertilizers = calculationForm?.fertilizers || [];\n  const fertilizersIDs = selectedFertilizers.map(f => f?.id)\n\n  const onChangeHandler = (item: FertilizerInfo | null) => {\n    item && setSelected(item)\n  }\n\n  const onChangeFertilizerElements = (item: FertilizerInfo) =>{\n    setSelected(item)\n  }\n\n  const onAddHandler = () => {\n    if (!selected) {\n      return\n    }\n    onAdd(selected)\n  }\n  return (\n    <Card>\n      <Flex flexDirection=\"column\">\n        <Flex justifyContent=\"space-between\">\n          <Box flex={1} pr={2}>\n            <Dropdown<FertilizerInfo>\n              value={selected}\n              items={fertilizers}\n              onChange={onChangeHandler}\n              checkDisabledItem={item => fertilizersIDs.includes(item?.id || \"\")}\n              renderItem={({item}) => (\n                <Flex flex={1} justifyContent=\"space-between\">\n                  <Box>\n                    {item.id}\n                  </Box>\n                </Flex>\n              )}\n              renderValue={item => item?.id || \"\"}\n            />\n          </Box>\n          <IconButton\n            onClick={onAddHandler}\n            component={Plus}/>\n\n        </Flex>\n        <AddItemFertilizerEditForm\n          fertilizer={selected}\n          onChange={onChangeFertilizerElements}\n        />\n      </Flex>\n\n    </Card>\n  )\n}\n\n","import React from \"react\";\nimport {Flex} from \"rebass\";\nimport {SelectedListItem} from \"./SelectedListItem\";\nimport {AddItem} from \"./AddItem\";\nimport {ReduxFieldArrayType} from \"../../ui/ReduxForm/types\";\nimport {FertilizerType} from \"./types\";\nimport {CalculatorState} from \"../types\";\nimport {useSelector} from \"react-redux\";\n\ninterface SelectedListProps {\n}\n\nexport const SelectedList: ReduxFieldArrayType<SelectedListProps, FertilizerType> = (\n  {fields, meta: {error}}) => {\n  const {\n    calculationForm,\n    result,\n  } = useSelector<any>(state => state.calculator) as CalculatorState\n  const fertilizers = calculationForm?.fertilizers || [];\n\n  const calculatedFertilizersWeights = Object.fromEntries((result?.fertilizers || []).map(f => [f.id, f]))\n\n  const onAddHandler = (item: FertilizerType) => {\n    for (let f of fertilizers) {\n      if (f.id === item.id) {\n        return\n      }\n    }\n    fields.push(item)\n  }\n  return (\n    <Flex sx={{flexDirection: 'column'}} width='auto'>\n      <AddItem onAdd={onAddHandler}/>\n      <Flex sx={{\n        flexDirection: 'column',\n        '& > *': {\n          marginTop: '8px !important',\n        }\n      }}>\n        {error ? <span>{error}</span> : null}\n        {fertilizers.map((item, index) =>\n          <SelectedListItem\n            item={item}\n            key={item.id}\n            weight={calculatedFertilizersWeights[item.id]}\n            onRemove={() => fields.remove(index)}\n          />\n        )}\n      </Flex>\n    </Flex>\n  )\n}\n","import React from \"react\";\nimport {SelectedList} from \"./SelectedList\";\nimport {FieldArray} from \"redux-form\";\nimport {required} from \"../../ui/ReduxForm/validators\";\n\n\nexport const Container = () => {\n  return (\n    <FieldArray<{}>\n      name={\"fertilizers\"}\n      component={SelectedList}\n      validate={required(\"Выберите удобрения\")}\n    />\n  )\n}\n\n","import {Container} from \"./Container\";\n\nexport default Container\n","\ntype ValidatorCallback = {\n  (value: any): void|string\n}\n\nexport function pattern(pattern: RegExp|string, message?: string): ValidatorCallback {\n  message = message || 'Значение должно соответствовать регулярному выражению'\n  return (value) => {\n    pattern = new RegExp(pattern) as RegExp\n    if (pattern.test(value)) {\n      return message\n    }\n  }\n}\n\nexport function minLength(length: number, message?: string): ValidatorCallback {\n  message = message || `Количество элементов должно быть не менее ${length}`\n\n  return value => {\n    if (value.length < length) {\n      return message\n    }\n  }\n}\n\n\nexport function required(message?: string): ValidatorCallback {\n  message = message || `Должно быть заполнено`\n\n  return value => {\n    if (!value || !value?.length) {\n      return message\n    }\n  }\n}\n\n","import React, {FunctionComponent} from \"react\";\nimport {Card, Flex, Heading} from \"rebass\";\nimport {Checkbox} from \"../../ui/ReduxForm/Checkbox\";\n\ninterface IgnoreElementProps {\n}\n\n\nexport const IgnoreElement: FunctionComponent<IgnoreElementProps> = () => {\n  return (\n    <Card>\n      <Flex flexDirection=\"column\">\n        <Heading fontSize={2}>Игнорировать</Heading>\n        <Checkbox name=\"ignore.Ca\" label=\"Кальций\" />\n        <Checkbox name=\"ignore.Mg\" label=\"Магний\" />\n        <Checkbox name=\"ignore.S\" label=\"Сера\" />\n        <Checkbox name=\"ignore.Cl\" label=\"Хлор\" />\n      </Flex>\n    </Card>\n  )\n}\n","import React from \"react\";\n\nimport {Label, Radio as RebassRadio, RadioProps as RebassRadioProps} from \"@rebass/forms\";\nimport {Field as ReduxField} from \"redux-form\";\nimport {ReduxFormComponentType, WrapperInputType} from \"./types\";\n\ninterface RadioProps extends RebassRadioProps {\n  label: string,\n  value: string | number,\n}\n\nconst WrappedCheckbox: WrapperInputType<RadioProps> = ({input, label, value, ...props}: any) =>\n  <Label>\n    <RebassRadio\n      {...props}\n      {...input}\n    />\n    {label}\n  </Label>\n\n// TODO вывести тип\nexport const Radio: ReduxFormComponentType<RadioProps> = ({\n                                                            name,\n                                                            value,\n                                                            normalize= (v) => v.toString(),\n                                                            ...props\n                                                          }) => {\n  return (\n    <ReduxField\n      component={WrappedCheckbox}\n      name={name}\n      normalize={normalize}\n      // onClick={() => setChecked(!checked)}\n      // checked={checked}\n      type='radio'\n      value={normalize(value)}\n      {...props as any}\n    />\n  )\n}\n","import React, {FunctionComponent} from \"react\";\nimport {Card, Flex, Heading} from \"rebass\";\nimport {Radio} from \"../../ui/ReduxForm/Radio\";\nimport {decimal} from \"../../ui/ReduxForm/normalizers\";\n\nconst ACCURACY_VARIANTS = [\n  0.2,\n  0.1,\n  0.05,\n  0.01,\n]\ninterface AccuracyProps {\n}\n\nexport const Accuracy: FunctionComponent<AccuracyProps> = () => {\n    return (\n      <Card>\n          <Flex flexDirection=\"column\">\n            <Heading fontSize={2}>Точность</Heading>\n            {ACCURACY_VARIANTS.map(a =>\n                <Radio\n                  name=\"accuracy\"\n                  value={a}\n                  label={`${a} г.`}\n                  normalize={decimal}\n                />\n            )}\n          </Flex>\n      </Card>\n    )\n}\n","import React, {FunctionComponent} from \"react\";\nimport {Card, Flex, Heading} from \"rebass\";\nimport {Label} from \"@rebass/forms\";\nimport {Input} from \"../../ui/ReduxForm/Input\";\nimport {decimal, number} from \"../../ui/ReduxForm/normalizers\";\n\n\ninterface SolutionVolumeProps {\n}\n\nexport const Solution: FunctionComponent<SolutionVolumeProps> = () => {\n  return (\n    <Card>\n        <Heading fontSize={2}>Раствор</Heading>\n      <Flex flexDirection=\"column\">\n        <Flex alignItems=\"center\" justifyContent=\"space-between\">\n          <Label htmlFor=\"solution_volume\">Объем, л</Label>\n          <Input\n            name=\"solution_volume\"\n            width=\"3rem\"\n            type=\"number\"\n            step=\"1\"\n            min=\"1\"\n            pattern=\"^\\d+$\"\n            normalize={number}\n            style={{\n              textAlign: \"center\"\n            }}\n            autoComplete=\"off\"\n          />\n        </Flex>\n        <Flex alignItems=\"center\" justifyContent=\"space-between\" paddingTop={2}>\n          <Label htmlFor=\"solution_concentration\">Концентрация, 1/100%</Label>\n          <Input\n            name=\"solution_concentration\"\n            width=\"3rem\"\n            type=\"number\"\n            step=\"0.1\"\n            min=\"0\"\n            max=\"999\"\n            normalize={decimal}\n            style={{\n              textAlign: \"center\"\n            }}\n            autoComplete=\"off\"\n          />\n        </Flex>\n      </Flex>\n    </Card>\n  )\n}\n","import React, {FunctionComponent} from \"react\";\nimport {useSelector} from \"react-redux\";\nimport {getFormValues} from \"redux-form\";\nimport {Card, Flex} from \"rebass\";\nimport {Label} from \"@rebass/forms\";\nimport {Input} from \"@/components/ui/ReduxForm/Input\";\nimport {decimal, number} from \"@/components/ui/ReduxForm/normalizers\";\nimport {Checkbox} from \"@/components/ui/ReduxForm/Checkbox\";\nimport {REDUX_FORM_NAME} from \"@/components/Calculator/constants\";\nimport {CalculatorFormValues} from \"@/components/Calculator/types\";\n\n\ninterface DilutionProps {\n}\n\nexport const Dilution: FunctionComponent<DilutionProps> = () => {\n  const {\n    dilution_enabled,\n  } = useSelector(getFormValues(REDUX_FORM_NAME)) as CalculatorFormValues\n  return (\n    <Card>\n      <Checkbox name=\"dilution_enabled\" label=\"Разбавление концетрата\"/>\n      <Flex flexDirection=\"column\" style={{display: dilution_enabled? \"flex\" : \"none\"}}>\n        <Flex alignItems=\"center\" justifyContent=\"space-between\">\n          <Label htmlFor=\"dilution_volume\">Объем, л</Label>\n          <Input\n            name=\"dilution_volume\"\n            width=\"3rem\"\n            type=\"number\"\n            step=\"1\"\n            min=\"1\"\n            pattern=\"^\\d+$\"\n            normalize={number}\n            style={{\n              textAlign: \"center\"\n            }}\n            autoComplete=\"off\"\n          />\n        </Flex>\n        <Flex alignItems=\"center\" justifyContent=\"space-between\" paddingTop={2}>\n          <Label htmlFor=\"dilution_concentration\">Концентрация, 1/100%</Label>\n          <Input\n            name=\"dilution_concentration\"\n            width=\"3rem\"\n            type=\"number\"\n            step=\"0.1\"\n            min=\"0\"\n            max=\"999\"\n            normalize={decimal}\n            style={{\n              textAlign: \"center\"\n            }}\n            autoComplete=\"off\"\n          />\n        </Flex>\n      </Flex>\n    </Card>\n  )\n}\n","import React, {ComponentType} from \"react\";\nimport {Box, Button, Flex} from \"rebass\";\nimport {IgnoreElement} from \"./IgnoreElement\";\nimport {Accuracy} from \"./Accuracy\";\nimport {Solution} from \"./Solution\";\nimport {Dilution} from \"./Dilution\";\n\ninterface OptionsProps {\n}\n\n\nexport const Options: ComponentType<OptionsProps> = () => {\n  return (\n    <Flex flexDirection=\"column\">\n      <Box flex={1}>\n        <Button width=\"100%\" my={2} type=\"submit\">Calculate</Button>\n      </Box>\n      <Box my={2}>\n        <Solution/>\n      </Box>\n      <Box my={2}>\n        <Dilution/>\n      </Box>\n      <Flex sx={{\n        '& > *': {flex: 1}\n      }}>\n        <IgnoreElement/>\n        <Box marginLeft={2}>\n          <Accuracy/>\n        </Box>\n      </Flex>\n\n    </Flex>\n  )\n}\n\n","import React, {FunctionComponent} from \"react\";\nimport {Box, Flex} from \"rebass\";\nimport {Input} from \"@/components/ui/ReduxForm/Input\";\nimport {number} from \"@/components/ui/ReduxForm/normalizers\";\n\ninterface RecipeElementFormProps {\n  name: string,\n}\n\nexport const getRecipeFieldName = (name: string) => `recipe.${name}`\n\n\n\nexport const RecipeElementForm: FunctionComponent<RecipeElementFormProps> = (props) => {\n  const {name} = props\n  return (\n    <Flex flexDirection=\"column\"\n          justifyContent=\"center\"\n          alignItems=\"center\"\n          maxWidth='3rem'\n    >\n      <Box style={{textAlign: 'center'}}\n      >\n        {name}\n      </Box>\n      <Input\n        name={getRecipeFieldName(name)}\n        type=\"number\"\n        step=\"0.1\"\n        min=\"0\"\n        max=\"999\"\n        autoComplete=\"off\"\n        normalize={number}\n        maxWidth=\"3rem\"\n        style={{\n          textAlign: \"center\"\n        }}\n      />\n    </Flex>\n  )\n}\n","import React, {ChangeEvent, useState} from \"react\";\nimport {Box, Button, Flex} from \"rebass\";\n\nimport {useFormName, useFormValues} from \"@/hooks/ReduxForm\";\nimport {CalculatorFormValues} from \"@/components/Calculator/types\";\nimport {calculateNPKBalance} from '@/calculator/helpers';\nimport {Elements, NeedElements} from \"@/calculator/types\";\nimport {decimal} from \"@/components/ui/ReduxForm/normalizers\";\nimport {FERTILIZER_ELEMENT_NAMES, MACRO_ELEMENT_NAMES, MICRO_ELEMENT_NAMES} from \"@/calculator/constants\";\nimport {StyledInput} from \"@/components/ui/ReduxForm/Input\";\nimport {ALLOWED_ELEMENT_IN_MATRIX, convertProfileWithEC, convertProfileWithRatio} from \"@/calculator/profile\";\nimport {StyledBalanceCell} from \"@/components/Calculator/Options/Recipe\";\nimport {round} from \"@/utils\";\nimport {ModalActions} from \"@/components/ui/Modal/Modal\";\n\ninterface RecipeTuneFormProps {\n  modal: ModalActions,\n  onSave: (npk: NeedElements) => void\n}\n\nconst ELEMENT_IN_MATRIX = ALLOWED_ELEMENT_IN_MATRIX.filter(el => ![\"NH4\", \"NO3\"].includes(el))\n\nexport function RecipeTuneForm(props: RecipeTuneFormProps) {\n  const formValue = useFormValues<CalculatorFormValues>(useFormName())[0]\n  const [recipe, setRecipe] = useState(formValue.recipe)\n  const recipeInfo = calculateNPKBalance(recipe as Elements)\n  const [ratio, setRatio] = useState(recipeInfo.ratio)\n  const [EC, setEC] = useState(recipeInfo.EC)\n\n  const onChangeRecipe = (el: FERTILIZER_ELEMENT_NAMES, value: number) => {\n    setRecipe({...recipe, [el]: value})\n  }\n  const onChangeEC = (val: number) => {\n    setRecipe(convertProfileWithEC(recipe as Elements, val))\n    setEC(val)\n  }\n  const onChangeRatio = (El1: ALLOWED_ELEMENT_IN_MATRIX, El2: ALLOWED_ELEMENT_IN_MATRIX, val: number) => {\n    if (val) {\n      let newNpk = convertProfileWithRatio(recipe, {[El1]: {[El2]: val}})\n      newNpk = convertProfileWithEC(newNpk, EC)\n      setRecipe(newNpk)\n    }\n    setRatio({...ratio, [El1]: {...ratio[El1], [El2]: val}})\n  }\n\n  const onSaveHandler = () => {\n    props.onSave(recipe)\n    props.modal.close()\n  }\n  return (\n    <Flex flexDirection={'column'}>\n      <Flex>\n        {MACRO_ELEMENT_NAMES.map(el => (\n          <RecipeInput\n            name={el}\n            label={el}\n            value={recipe[el]}\n            onChange={val => onChangeRecipe(el, val)}\n            step={0.1}\n          />\n        ))}\n        <RecipeInput name={'EC'} label={\"EC\"} value={EC} onChange={onChangeEC}/>\n      </Flex>\n      <Flex justifyContent=\"space-around\">\n        <StyledBalanceCell name=\"ΔΣ I\" value={recipeInfo.ion_balance}/>\n        <StyledBalanceCell name=\"EC\" value={recipeInfo.EC}/>\n        <RecipeInput\n          name={'NH4'}\n          label={\"%NH4\"}\n          value={round(ratio.NH4.NO3 * 100, 1)}\n          step={0.1}\n          onChange={v => onChangeRatio('NH4', 'NO3', v / 100)}\n        />\n        <StyledBalanceCell name=\"K:Mg\" value={recipeInfo.ratio.K.Mg}/>\n        <StyledBalanceCell name=\"K:Ca\" value={recipeInfo.ratio.K.Ca}/>\n        <StyledBalanceCell name=\"Ca:N\" value={recipeInfo.ratio.Ca.N}/>\n        <StyledBalanceCell name=\"N:K\" value={recipeInfo.ratio.N.K}/>\n        <StyledBalanceCell name=\"N:P\" value={recipeInfo.ratio.N.P}/>\n      </Flex>\n      <Flex>\n        <table>\n          <thead>\n          <tr>\n            <th></th>\n            {ELEMENT_IN_MATRIX.map(el => <th>{el}</th>)}\n          </tr>\n          </thead>\n          <tbody>\n          {ELEMENT_IN_MATRIX.map(el => (\n            <tr>\n              <th>{el}</th>\n              {ELEMENT_IN_MATRIX.map(el2 => (\n                <td style={{textAlign: 'center'}}>\n                  {el === el2 ? 1 : (\n                    <RecipeInput\n                      name={`${el}:${el2}`}\n                      value={round(ratio?.[el]?.[el2] || 0, 2)}\n                      onChange={value => onChangeRatio(el, el2, value)}\n                    />\n                  )}\n                </td>\n              ))}\n\n            </tr>\n\n          ))}\n          </tbody>\n        </table>\n      </Flex>\n      <Flex justifyContent=\"space-around\">\n        {MICRO_ELEMENT_NAMES.map(el => (\n          <RecipeInput\n            name={el}\n            label={el}\n            value={(recipe[el] || 0) * 1000}\n            onChange={val => onChangeRecipe(el, val / 1000)}\n            step={1}\n          />\n        ))}\n      </Flex>\n      <Flex justifyContent=\"space-between\">\n        <Button type=\"button\" onClick={props.modal.close}>Cancel</Button>\n        <Button type=\"button\" onClick={onSaveHandler}>Save</Button>\n      </Flex>\n    </Flex>\n  )\n}\n\ninterface RecipeInputProps {\n  name: string,\n  label?: string,\n  onChange?: (value: number) => void,\n  value?: number,\n  step?: number,\n}\n\nfunction RecipeInput(props: RecipeInputProps) {\n  const {\n    name, label, onChange,\n    value = 0,\n    step = 0.01\n  } = props\n\n  const onChangeHandler = (e: ChangeEvent<HTMLInputElement>) => {\n    if (e.target.value) {\n      const val = decimal(e.target.value)\n      onChange && onChange(val)\n    }\n  }\n\n  return (\n    <Flex flexDirection=\"column\"\n          justifyContent=\"center\"\n          alignItems=\"center\"\n          maxWidth='6rem'\n    >\n      {label ?\n        <Box style={{textAlign: 'center'}}>\n          {label}\n        </Box>\n        : null\n      }\n      <StyledInput\n        onChange={onChangeHandler}\n        name={name}\n        value={value}\n        type=\"number\"\n        step={step.toString()}\n        min=\"0\"\n        max=\"9999\"\n        autoComplete=\"off\"\n        maxWidth=\"6rem\"\n        lang=\"en-US\"\n        style={{\n          textAlign: \"center\"\n        }}\n      />\n    </Flex>\n  )\n}\n","import React, {FunctionComponent, useState} from \"react\";\nimport {Box, Card, Flex, Heading, Text} from \"rebass\";\nimport {Broom} from '@styled-icons/fa-solid/Broom'\nimport {Save} from '@styled-icons/boxicons-regular/Save'\nimport {Tune} from '@styled-icons/material-sharp/Tune'\nimport {getRecipeFieldName, RecipeElementForm} from \"./RecipeElementForm\";\nimport {useFormName, useFormValues} from \"@/hooks/ReduxForm\";\nimport {FERTILIZER_ELEMENT_NAMES, MACRO_ELEMENT_NAMES} from \"@/calculator/constants\";\n\nimport {IconButton} from \"@/components/ui/IconButton\";\nimport {Dropdown} from \"@/components/ui/Dropdown/Dropdown\";\nimport {CalculatorState, Recipe as RecipeType} from \"@/components/Calculator/types\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {recipePush, recipeRemove} from \"@/components/Calculator/actions\";\nimport {Elements, NeedElements} from \"@/calculator/types\";\nimport {calculateNPKBalance, getEmptyElements} from \"@/calculator/helpers\";\nimport {Modal} from \"@/components/ui/Modal/Modal\";\nimport {RecipeTuneForm} from \"@/components/Calculator/Options/RecipeTuneForm\";\nimport {round} from \"@/utils\";\n\n\nexport const StyledBalanceCell: FunctionComponent<{name:string, value: number}> = (props) => {\n  return (\n    <Flex flexDirection=\"column\" m={1} alignItems=\"center\">\n      <Heading fontSize={1}>{props.name}</Heading>\n      <Text>{props.value}</Text>\n    </Flex>\n  )\n}\n\ninterface RecipeProps {\n}\n\nexport const Recipe: FunctionComponent<RecipeProps> = () => {\n  const {\n    recipes = [],\n  } = useSelector<any>(state => state.calculator) as CalculatorState\n\n  const [values, setValue] = useFormValues(useFormName())\n  const [selected, setSelected] = useState<RecipeType | undefined>(recipes?.[0])\n\n  const dispatch = useDispatch()\n\n  const NPKBalance = calculateNPKBalance(values.recipe || getEmptyElements())\n\n  const onChangeHandler = (item: RecipeType | null) => {\n    item && setSelected(item)\n    item && setRecipe(item.elements)\n  }\n\n  const setRecipe = (elements: NeedElements) => {\n    for (let [name, value] of Object.entries(elements)) {\n      setValue(getRecipeFieldName(name), value)\n    }\n  }\n  const resetRecipe = () => {\n    let zeroValues = Object.fromEntries(FERTILIZER_ELEMENT_NAMES.map(el => [el, 0])) as unknown as Elements\n    setRecipe(zeroValues)\n  }\n  const onEditHandler = (value: string) => {\n    let zeroValues = Object.fromEntries(FERTILIZER_ELEMENT_NAMES\n      .map(el => [el, selected?.elements[el] || 0])) as unknown as Elements\n    setSelected({name: value, elements: zeroValues})\n  }\n\n  const onAddHandler = () => {\n    if (!selected) {\n      return\n    }\n    const recipe = {...selected, elements: values.recipe}\n    dispatch(recipePush(recipe))\n  }\n  const onRemoveItemHandler = (item: RecipeType) => {\n    dispatch(recipeRemove(item))\n  }\n  return (\n    <Card>\n      <Flex flexDirection=\"column\">\n        <Flex\n        >\n          <Box flex={1} mx={2}>\n            <Dropdown<RecipeType>\n              value={selected}\n              items={recipes}\n              onChange={onChangeHandler}\n              onEdit={onEditHandler}\n              renderItem={({item}) => (\n                <Flex flex={1} justifyContent=\"space-between\">\n                  <Box width={3} backgroundColor={item.color || 'gray'}>\n                  </Box>\n                  <Box flex={1} mx={2}>\n                    {item.name}\n                  </Box>\n                  <button onClick={event => {\n                    event.stopPropagation()\n                    onRemoveItemHandler(item)\n                  }}>-\n                  </button>\n                </Flex>\n              )}\n              renderValue={item => item?.name || \"\"}\n            />\n          </Box>\n          <Box>\n            <IconButton\n              marginRight={1}\n              component={Save}\n              onClick={onAddHandler}\n            />\n            <IconButton\n              component={Broom}\n              onClick={resetRecipe}\n            />\n          </Box>\n        </Flex>\n        <Flex justifyContent=\"space-between\">\n          {\n            MACRO_ELEMENT_NAMES.map(n => <RecipeElementForm name={n}/>)\n          }\n        </Flex>\n        <Flex justifyContent=\"space-around\">\n          <Modal\n            title=\"Настройка профиля\"\n            button={({modal}) => (\n              <IconButton\n              marginRight={1}\n              component={Tune}\n              onClick={modal.open}\n              />\n            )}\n            container={({modal}) => (\n              <>\n                <RecipeTuneForm\n                  modal={modal}\n                  onSave={setRecipe}\n                />\n              </>\n            )}\n          />\n          <StyledBalanceCell name=\"ΔΣ I\" value={NPKBalance.ion_balance}/>\n          <StyledBalanceCell name=\"EC\" value={NPKBalance.EC}/>\n          <StyledBalanceCell name=\"%NH4\" value={round(NPKBalance.ratio.NH4.NO3 * 100, 1)}/>\n          <StyledBalanceCell name=\"K:Mg\" value={NPKBalance.ratio.K.Mg}/>\n          <StyledBalanceCell name=\"K:Ca\" value={NPKBalance.ratio.K.Ca}/>\n          <StyledBalanceCell name=\"Ca:N\" value={NPKBalance.ratio.Ca.N}/>\n        </Flex>\n      </Flex>\n    </Card>\n  )\n}\n","import React from \"react\";\nimport {countDecimals, round} from \"@/utils\";\nimport {useSelector} from \"react-redux\";\nimport {getFormValues} from \"redux-form\";\nimport {REDUX_FORM_NAME} from \"@/components/Calculator/constants\";\nimport {CalculatorFormValues} from \"@/components/Calculator/types\";\nimport {FertilizerWeights} from \"@/calculator\";\n\ninterface ResultFertilizerListProps {\n    fertilizers: FertilizerWeights[],\n}\n\n\nexport function ResultFertilizerList(props: ResultFertilizerListProps) {\n    const {fertilizers} = props\n    const {\n      accuracy\n    } = useSelector(getFormValues(REDUX_FORM_NAME)) as CalculatorFormValues\n    return (\n        <>\n            {fertilizers.map(f => {\n                return (\n                  <li key={f.id}>\n                      {round(f.weight, countDecimals(accuracy))}г\n                      &nbsp;\n                      <span title=\"Объем или вес раствора\">{f.volume && `(${f.volume} мл${f.liquid_weight? `, ${f.liquid_weight}г`: ''})`}</span>\n                      &nbsp;\n                      {f.id}\n                  </li>\n                )\n            })}\n        </>\n    )\n}\n","import {useSelector} from \"react-redux\";\nimport {CalculatorFormValues, CalculatorState} from \"@/components/Calculator/types\";\nimport {entries, toMap} from \"@/utils\";\nimport {groupFertilizerBySolution} from \"@/calculator/dilution\";\nimport {FertilizerWeights} from \"@/calculator\";\nimport {calculatePPM} from \"@/calculator/helpers\";\nimport {getFormValues} from \"redux-form\";\nimport {REDUX_FORM_NAME} from \"@/components/Calculator/constants\";\n\nexport function usePPM() {\n  const {\n    result,\n  } = useSelector<any>(state => state.calculator) as CalculatorState\n  const {\n    solution_volume,\n  } = useSelector(getFormValues(REDUX_FORM_NAME)) as CalculatorFormValues\n\n  const fertilizerWeights = (result?.fertilizers || []).map(f => ({...f}))\n\n  const ppm = calculatePPM(\n    fertilizerWeights,\n    solution_volume,\n  );\n\n  return ppm\n}\n\nexport function useFertilizerSolutionGroup() {\n  const {\n    fertilizers,\n    result,\n  } = useSelector<any>(state => state.calculator) as CalculatorState\n\n  const fertilizersWeights = (result?.fertilizers || []).map(f => ({...f}))\n\n  const fertilizerWeightsMap = toMap(fertilizersWeights, 'id')\n\n  const pairs = entries(groupFertilizerBySolution(fertilizers))\n    .sort(([a], [b]) => a > b ? 1 : -1)\n  const fertilizerWeightGroups: [typeof pairs[0][0], FertilizerWeights[]][] = pairs\n    .map(([g, fList]) => {\n        let ws = fList\n          .map((f) => fertilizerWeightsMap[f.id])\n          .filter(f => f)\n        return [g, ws]\n      }\n    )\n\n  return fertilizerWeightGroups\n\n}\n","import {FertilizerInfo} from \"./types\";\nimport {normalizeFertilizer} from \"./fertilizer\";\nimport {round} from \"../utils\";\n\nexport interface Solution {\n  id: string,\n  volume: number,\n  concentration: number,\n  // TODO плотность\n}\n\nexport type DilutionResult = Omit<Solution, \"concentration\">\n\nexport function dilution_solution(target: Solution, sources: Omit<Solution, \"volume\">[]): DilutionResult[] {\n  const result: DilutionResult[] = []\n  for (let s of sources) {\n    result.push({\n      id: s.id,\n      volume: round((target.volume / s.concentration) * target.concentration, 2)\n    })\n  }\n  return result\n}\n\n\ntype FertilizerGroupBySolution = { [K in \"A\" | \"B\" | \"C\"]?: FertilizerInfo[] }\n\n// Делим удобрения на несколько растворов\n// Бутылка-1 Макра-азотная\n// Селитра амиачная\n// Селитра калиевая\n// Селитра кальциевая\n//\n// Бутылка 2 Макра-серно-фосфорная\n// Сульфат аммония\n// Сульфат магния семиводный\n// Монофосфат калия\nexport function groupFertilizerBySolution(fertilizers: FertilizerInfo[]): FertilizerGroupBySolution {\n  const groups: FertilizerGroupBySolution = {}\n  for (let f of fertilizers) {\n    let nf = normalizeFertilizer(f)\n    if (nf.elements.NO3) {\n      groups.A = [...groups.A || [], f]\n      continue\n    }\n    if (nf.elements.S || nf.elements.P) {\n      groups.B = [...groups.B || [], f]\n      continue\n    }\n    groups.C = [...groups.C || [], f]\n\n  }\n  return groups\n}\n","import React from \"react\";\nimport {dilution_solution, DilutionResult} from \"@/calculator/dilution\";\nimport {useSelector} from \"react-redux\";\nimport {getFormValues} from \"redux-form\";\nimport {REDUX_FORM_NAME} from \"@/components/Calculator/constants\";\nimport {CalculatorFormValues} from \"@/components/Calculator/types\";\nimport {useFertilizerSolutionGroup, usePPM} from \"@/components/Calculator/Result/hooks\";\nimport {Flex, Heading} from \"rebass\";\nimport {ppmToEC} from \"@/calculator/helpers\";\nimport {round} from \"@/utils\";\n\ninterface DilutionResultProps {\n}\n\nexport function ResultDilution(props: DilutionResultProps) {\n  const {\n    solution_concentration,\n    dilution_enabled,\n    dilution_volume,\n    dilution_concentration,\n  } = useSelector(getFormValues(REDUX_FORM_NAME)) as CalculatorFormValues\n\n  const fertilizerWeightGroups = useFertilizerSolutionGroup()\n  let ppm = usePPM()\n\n  if (!dilution_enabled) {\n    return null\n  }\n\n  ppm = round((dilution_concentration * ppm) / solution_concentration)\n\n  let dilution: DilutionResult[] | null = null\n\n  dilution = dilution_solution({\n    id: \"Total\",\n    volume: dilution_volume,\n    concentration: dilution_concentration,\n  }, fertilizerWeightGroups.map(([g]) => (\n    {\n      id: g, concentration: solution_concentration\n    })))\n\n  return (\n    <>\n      <Flex flexDirection=\"column\" width=\"75%\">\n        <Heading fontSize={2}>Разбавление</Heading>\n          <ul>\n            {dilution.map(d => (\n              <li>Раствор {d.id} - {d.volume}л</li>\n            ))}\n            <li>\n              Долить до {dilution_volume}л\n            </li>\n            <li>\n              <b>TDS:</b> {ppm} ppm; <b>EC:</b> {ppmToEC(ppm, 1)} мСм/см\n            </li>\n          </ul>\n      </Flex>\n\n    </>\n  )\n}\n","import React, {FunctionComponent} from \"react\";\nimport {Card, Flex, Heading, Text} from \"rebass\";\nimport {useSelector} from \"react-redux\";\nimport {CalculatorFormValues, CalculatorState} from \"../types\";\nimport {getFormValues} from \"redux-form\";\nimport {REDUX_FORM_NAME} from \"../constants\";\nimport {MACRO_ELEMENT_NAMES, MICRO_ELEMENT_NAMES} from \"@/calculator/constants\";\nimport {Element} from \"../FertilizerSelect/SelectedListItem\";\nimport styled from \"styled-components\";\nimport {calculateNPKBalance, getEmptyElements, ppmToEC} from \"@/calculator/helpers\";\nimport {StyledBalanceCell} from \"../Options/Recipe\";\nimport {ResultFertilizerList} from \"./ResultFertilizerList\";\nimport {useFertilizerSolutionGroup, usePPM} from \"./hooks\";\nimport {ResultDilution} from \"@/components/Calculator/Result/ResultDilution\";\nimport {round} from \"@/utils\";\n\ninterface ResultProps {\n}\n\nconst StyledList = styled.ul`\n  @media screen and (min-width: 800px) {\n    width: 75%;\n  }\n`\n\nfunction getScoreDisplay(score: number): string {\n  let score_display = \"Не соответствует\";\n  if (score >= 95) score_display = \"Идеально\";\n  if (score >= 90 && score < 95) score_display = \"Отлично\";\n  if (score >= 85 && score < 90) score_display = \"Очень хорошо\";\n  if (score >= 80 && score < 85) score_display = \"Хорошо\";\n  if (score >= 70 && score < 80) score_display = \"Средне\";\n  if (score >= 60 && score < 70) score_display = \"Плохо\";\n  if (score >= 40 && score < 60) score_display = \"Ужасно\";\n  return score_display\n}\n\n\nexport const Result: FunctionComponent<ResultProps> = () => {\n  const {\n    result,\n  } = useSelector<any>(state => state.calculator) as CalculatorState\n\n  const {\n    solution_volume,\n  } = useSelector(getFormValues(REDUX_FORM_NAME)) as CalculatorFormValues\n\n  const ppm = usePPM()\n  const fertilizerWeightGroups = useFertilizerSolutionGroup()\n\n  const score = result?.score || 0\n  const elements = result?.elements || getEmptyElements()\n  const deltaElements = result?.deltaElements || getEmptyElements()\n  const NPKBalance = calculateNPKBalance(elements)\n\n  return (\n    <Card>\n      <Flex alignItems=\"center\" flexDirection=\"column\" width=\"100%\">\n        <Flex justifyContent=\"space-around\" width=\"100%\">\n          {elements && MACRO_ELEMENT_NAMES.map(\n            k => <Element\n              key={k}\n              name={k}\n              value={round(elements[k])}\n              delta={round(deltaElements[k])}\n            />\n          )}\n        </Flex>\n        <Flex justifyContent=\"space-around\" width=\"100%\">\n          {elements && MICRO_ELEMENT_NAMES.map(\n            k => <Element\n              key={k}\n              name={k}\n              value={round(elements[k] * 1000)}\n              delta={round(deltaElements[k] * 1000)}\n            />\n          )}\n        </Flex>\n        <Flex justifyContent=\"space-around\">\n          <StyledBalanceCell name=\"ΔΣ I\" value={NPKBalance.ion_balance}/>\n          <StyledBalanceCell name=\"EC\" value={NPKBalance.EC}/>\n          <StyledBalanceCell name=\"%NH4\" value={round(NPKBalance.ratio.NH4.NO3 * 100, 1)}/>\n          <StyledBalanceCell name=\"K:Mg\" value={NPKBalance.ratio.K.Mg}/>\n          <StyledBalanceCell name=\"K:Ca\" value={NPKBalance.ratio.K.Ca}/>\n          <StyledBalanceCell name=\"Ca:N\" value={NPKBalance.ratio.Ca.N}/>\n        </Flex>\n        <Heading fontSize={2}>\n          Оценка: {getScoreDisplay(score)}\n        </Heading>\n\n        <Text fontSize={6}>{`${score || 0}%`}</Text>\n        <StyledList>\n          <li>{solution_volume}л воды</li>\n          {fertilizerWeightGroups.map(([g, f_weights]) =>\n            (<li>\n                <b> Раствор {g} </b>\n                <ul>\n                  <ResultFertilizerList fertilizers={f_weights}/>\n                </ul>\n              </li>\n            )\n          )}\n          <li title=\"Или минерализация, в мг/л\">\n            <b>TDS:</b> {ppm} ppm; <b>EC:</b> {ppmToEC(ppm, 1)} мСм/см\n          </li>\n        </StyledList>\n        <ResultDilution/>\n        {result?.stats &&\n        <Text>\n          Обработано вариантов: {result?.stats.count} Время: {result?.stats.time} сек\n        </Text>\n        }\n      </Flex>\n    </Card>\n  )\n}\n\n","import parse from \"csv-parse/lib/sync\"\nimport stringify from \"csv-stringify/lib/sync\"\n\nexport const csvParse = parse\nexport const csvExport = stringify\n\n\n","import React, {ChangeEvent, createRef, useEffect, useState} from \"react\";\nimport {Import} from \"@styled-icons/boxicons-regular/Import\"\nimport {IconButton} from \"@/components/ui/IconButton\";\nimport {csvParse} from \"@/utils/csv\";\nimport {FERTILIZER_ELEMENT_NAMES} from \"@/calculator/constants\";\nimport {buildNPKFertilizer} from \"@/calculator/fertilizer\";\nimport {useDispatch} from \"react-redux\";\nimport {fertilizerPush} from \"@/components/Calculator/actions\";\n\ninterface ImportFertilizersProps {\n}\n\nconst COLUMNS = ['id', ...FERTILIZER_ELEMENT_NAMES]\n\nexport function ImportFertilizers(props: ImportFertilizersProps) {\n  const buttonRef = createRef<HTMLButtonElement>()\n  const dispatch = useDispatch()\n  const [size, setSize] = useState({width: 0, height: 0})\n  useEffect(() => {\n    const newSize = {\n      width: buttonRef.current?.offsetWidth || 0,\n      height: buttonRef.current?.offsetHeight || 0,\n    }\n    if (size.width !== newSize.width) {\n      setSize(newSize)\n    }\n  }, [buttonRef, size.width])\n\n  const loadCSV = (csv: string) => {\n    const p = csvParse(csv, {columns: COLUMNS})\n    if (isNaN(parseInt(p[0].P))) {\n      p.splice(0, 1)\n    }\n    for (let {id, ...npk} of p) {\n      const f = buildNPKFertilizer(id, npk)\n      dispatch(fertilizerPush(f))\n    }\n  }\n\n  const handleOnChange = (e: ChangeEvent<HTMLInputElement>) => {\n    console.log(e.target.value, e.target.files?.[0])\n    const file = e.target.files?.[0]\n    if (!file) {\n      return file\n    }\n    let reader = new FileReader();\n    reader.onload = () => {\n      console.log(reader.result)\n      loadCSV(reader.result as string)\n\n    }\n    reader.readAsText(file)\n\n  }\n  return (\n    <>\n      <IconButton\n        sx={{\n          position: \"relative\"\n        }}\n        ref={buttonRef}\n        component={Import}\n      >\n        <input type=\"file\"\n               accept=\"text/csv, .csv\"\n               onChange={event => handleOnChange(event)}\n               style={{\n                 top: 0,\n                 left: 0,\n                 position: \"absolute\",\n                 opacity: 0,\n                 ...size,\n               }}\n        />\n      </IconButton>\n    </>\n  )\n}\n","export const saveData = (function () {\n  const a = document.createElement(\"a\");\n  document.body.appendChild(a);\n  a.setAttribute('style', \"display: none\")\n  return function (data: string, fileName: string) {\n    const blob = new Blob([data], {type: \"octet/stream\"})\n    const url = window.URL.createObjectURL(blob)\n    a.href = url;\n    a.download = fileName;\n    a.click();\n    window.URL.revokeObjectURL(url);\n  };\n})();\n\nexport {}\n","import React from \"react\";\nimport {Export} from \"@styled-icons/boxicons-regular/Export\"\nimport {IconButton} from \"@/components/ui/IconButton\";\nimport {useSelector} from \"react-redux\";\nimport {CalculatorState} from \"@/components/Calculator/types\";\nimport {normalizeFertilizer} from \"@/calculator/fertilizer\";\nimport {FERTILIZER_ELEMENT_NAMES} from \"@/calculator/constants\";\nimport {csvExport} from \"@/utils/csv\";\nimport {saveData} from \"@/utils/downloads\";\n\ninterface ExportFertilizersProps {\n}\n\nexport function ExportFertilizers(props: ExportFertilizersProps) {\n  const {\n    fertilizers,\n  } = useSelector<any>(state => state.calculator) as CalculatorState\n  const doExport = () => {\n    const npkFertilizer = fertilizers.map(f => normalizeFertilizer(f, false))\n    const rows = npkFertilizer.map(f => {\n      const cols = FERTILIZER_ELEMENT_NAMES.map(n => f.elements[n])\n      return [f.id, ...cols]\n    })\n    const csvData = csvExport(rows, {columns: ['Удобрение', ...FERTILIZER_ELEMENT_NAMES], header: true})\n    saveData(csvData, \"Удобрения.csv\")\n  }\n  return (\n    <>\n      <IconButton onClick={doExport} component={Export}/>\n    </>\n  )\n}\n","import React from \"react\";\nimport {Export} from \"@styled-icons/boxicons-regular/Export\"\nimport {IconButton} from \"@/components/ui/IconButton\";\nimport {useSelector} from \"react-redux\";\nimport {CalculatorState} from \"@/components/Calculator/types\";\nimport {FERTILIZER_ELEMENT_NAMES} from \"@/calculator/constants\";\nimport {csvExport} from \"@/utils/csv\";\nimport {saveData} from \"@/utils/downloads\";\n\ninterface ExportRecipesProps {\n}\n\nexport function ExportRecipes(props: ExportRecipesProps) {\n  const {\n    recipes,\n  } = useSelector<any>(state => state.calculator) as CalculatorState\n  const doExport = () => {\n    const rows = recipes.map(f => {\n      const cols = FERTILIZER_ELEMENT_NAMES.map(n => f.elements[n])\n      return [f.name, ...cols]\n    })\n    const csvData = csvExport(rows, {columns: ['Профиль', ...FERTILIZER_ELEMENT_NAMES], header: true})\n    saveData(csvData, \"Профили.csv\")\n  }\n  return (\n    <>\n      <IconButton onClick={doExport} component={Export}/>\n    </>\n  )\n}\n","import React, {ChangeEvent, createRef, useEffect, useState} from \"react\";\nimport {Import} from \"@styled-icons/boxicons-regular/Import\"\nimport {IconButton} from \"@/components/ui/IconButton\";\nimport {csvParse} from \"@/utils/csv\";\nimport {FERTILIZER_ELEMENT_NAMES} from \"@/calculator/constants\";\nimport {useDispatch} from \"react-redux\";\nimport {recipePush} from \"@/components/Calculator/actions\";\n\ninterface ImportRecipesProps {\n}\n\nconst COLUMNS = ['id', ...FERTILIZER_ELEMENT_NAMES]\n\nexport function ImportRecipes(props: ImportRecipesProps) {\n  const buttonRef = createRef<HTMLButtonElement>()\n  const dispatch = useDispatch()\n  const [size, setSize] = useState({width: 0, height: 0})\n  useEffect(() => {\n    const newSize = {\n      width: buttonRef.current?.offsetWidth || 0,\n      height: buttonRef.current?.offsetHeight || 0,\n    }\n    if (size.width !== newSize.width) {\n      setSize(newSize)\n    }\n  }, [buttonRef, size.width])\n\n  const loadCSV = (csv: string) => {\n    const p = csvParse(csv, {columns: COLUMNS})\n    if (isNaN(parseInt(p[0].P))) {\n      p.splice(0, 1)\n    }\n    for (let {id, ...npk} of p) {\n      dispatch(recipePush({name: id, elements: npk}))\n    }\n  }\n\n  const handleOnChange = (e: ChangeEvent<HTMLInputElement>) => {\n    console.log(e.target.value, e.target.files?.[0])\n    const file = e.target.files?.[0]\n    if (!file) {\n      return file\n    }\n    let reader = new FileReader();\n    reader.onload = () => {\n      console.log(reader.result)\n      loadCSV(reader.result as string)\n\n    }\n    reader.readAsText(file)\n\n  }\n  return (\n    <>\n      <IconButton\n        sx={{\n          position: \"relative\"\n        }}\n        ref={buttonRef}\n        component={Import}\n      >\n        <input type=\"file\"\n               accept=\"text/csv, .csv\"\n               onChange={event => handleOnChange(event)}\n               style={{\n                 top: 0,\n                 left: 0,\n                 position: \"absolute\",\n                 opacity: 0,\n                 ...size,\n               }}\n        />\n      </IconButton>\n    </>\n  )\n}\n","import {SxStyleProp} from \"rebass\";\n\nexport function mobileStyles(styles: SxStyleProp) {\n  return {\n    '@media screen and (max-width: 800px)': styles\n  }\n}\n","import React from \"react\";\nimport {Box, Card, Flex, Heading, Text} from 'rebass'\nimport {Restart} from \"@styled-icons/remix-line/Restart\"\nimport {Form, reduxForm} from \"redux-form\";\nimport {connect, useDispatch} from \"react-redux\";\n\nimport FertilizerSelect from './FertilizerSelect'\nimport {Options} from \"./Options/Options\";\nimport {Result} from \"./Result/Result\";\nimport {CalculatorFormValues} from \"./types\";\nimport {ReduxFormType} from \"../ui/ReduxForm/types\";\nimport {REDUX_FORM_NAME} from \"./constants\";\nimport {calculateStart, fertilizerReset, recipeReset} from \"./actions\";\nimport {ImportFertilizers} from \"@/components/Calculator/ImportExport/ImportFertilizers\";\nimport {ExportFertilizers} from \"@/components/Calculator/ImportExport/ExportFertilizers\";\nimport {IconButton} from \"@/components/ui/IconButton\";\nimport {DEFAULT_MICRO_RECIPE, DEFAULT_RECIPES} from \"@/components/Calculator/constants/recipes\";\nimport {ExportRecipes} from \"@/components/Calculator/ImportExport/ExportRecipes\";\nimport {ImportRecipes} from \"@/components/Calculator/ImportExport/ImportRecipes\";\nimport {Recipe} from \"@/components/Calculator/Options/Recipe\";\nimport {mobileStyles} from \"@/components/ui/styled\";\nimport {RootState} from \"@/redux/types\";\n\ninterface CalculatorProps {\n\n}\n\nconst initialValues: CalculatorFormValues = {\n  accuracy: 0.2,\n  solution_volume: 1,\n  solution_concentration: 100,\n  recipe: {...DEFAULT_RECIPES[0].elements, ...DEFAULT_MICRO_RECIPE, Cl: 0},\n  fertilizers: [],\n  dilution_enabled: false,\n  dilution_volume: 20,\n  dilution_concentration: 1,\n}\nexport const CalculatorContainer: ReduxFormType<CalculatorProps, CalculatorFormValues> = ({handleSubmit}) => {\n  const dispatch = useDispatch()\n  return (\n    <Form\n      onSubmit={handleSubmit(() => {\n        dispatch(calculateStart())\n      })}\n    >\n      <Flex sx={{\n        flexDirection: 'row',\n        ...mobileStyles({\n          flexDirection: 'column-reverse',\n        })\n      }}>\n        <Box flex={1}\n             sx={{\n               marginRight: 2,\n               ...mobileStyles({\n                 marginRight: 0\n               })\n             }}\n        >\n          <FertilizerSelect/>\n        </Box>\n        <Flex flexDirection='column' flex={1}>\n          <Box flex={1} marginBottom={2}>\n            <Recipe/>\n          </Box>\n          <Box flex={1}>\n            <Result/>\n          </Box>\n          <Box flex={1}>\n            <Options/>\n          </Box>\n          <Card>\n            <Heading fontSize={2}>Импорт/Экспорт</Heading>\n            <Flex flexDirection=\"column\" p={3}>\n              <Flex alignItems='center'\n                    paddingBottom={2}\n                    justifyContent=\"space-between\"\n                    flexWrap=\"wrap\"\n              >\n                <Text>Удобрения</Text>\n                <Box sx={{\n                  \"&>*\": {\n                    marginLeft: 1\n                  }\n                }}>\n                  <ImportFertilizers/>\n                  <ExportFertilizers/>\n                  <IconButton\n                    component={Restart}\n                    onClick={() => dispatch(fertilizerReset())}\n                  />\n                </Box>\n              </Flex>\n              <Flex alignItems='center'\n                    justifyContent=\"space-between\"\n                    flexWrap=\"wrap\"\n              >\n                <Text>Рецепты</Text>\n                <Box sx={{\n                  \"&>*\": {\n                    marginLeft: 1\n                  }\n                }}>\n                  <ImportRecipes/>\n                  <ExportRecipes/>\n                  <IconButton\n                    component={Restart}\n                    onClick={() => dispatch(recipeReset())}\n                  />\n                </Box>\n              </Flex>\n            </Flex>\n          </Card>\n        </Flex>\n      </Flex>\n    </Form>\n  )\n}\n\n\nconst InitializerCalculator = reduxForm<CalculatorFormValues>({\n  form: REDUX_FORM_NAME,\n  initialValues,\n  enableReinitialize: true\n})(CalculatorContainer)\n\nconst ReduxCalculator = connect((state: RootState) => {\n  const formValues: CalculatorFormValues = (state.calculator?.calculationForm || initialValues)\n  return {\n    initialValues: {\n      ...formValues,\n      recipe: {Cl: 0, ...DEFAULT_MICRO_RECIPE, ...formValues.recipe}\n    }\n  }})(InitializerCalculator)\n\nexport default ReduxCalculator\n"],"sourceRoot":""}